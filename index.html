<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>LANA â¤ï¸ ANAS</title>

  <!-- Ù†ÙØ³ Ø³ØªØ§ÙŠÙ„Ùƒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ù…Ø®ØªØµØ± Ù„Ù„Ù‘ÙˆØ¨ÙŠ) -->
  <style>
    :root{
      --bg1:#160614; --bg2:#2a0b22; --bg3:#3a0f2d;
      --glass: rgba(255,255,255,.08);
      --stroke: rgba(255,255,255,.16);
      --txt: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --accent:#ff2d55;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans Arabic", "Noto Kufi Arabic", sans-serif;
      color:var(--txt);
      overflow:auto;
      background:
        radial-gradient(1100px 700px at 10% 10%, rgba(255,45,85,.18), transparent 60%),
        radial-gradient(900px 600px at 90% 20%, rgba(255,77,125,.16), transparent 60%),
        radial-gradient(1000px 700px at 70% 95%, rgba(255,45,85,.14), transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2), var(--bg3));
    }

    .hearts{ position:fixed; inset:-20vh 0 0 0; pointer-events:none; overflow:hidden; z-index:2; }
    .heart{ position:absolute; top:-20vh; font-size:22px; opacity:.95; animation: fall linear infinite; will-change: transform; text-shadow: 0 12px 24px rgba(0,0,0,.35); }
    @keyframes fall{ to{ transform: translateY(130vh) rotate(25deg); } }

    .wrap{
      position:relative; min-height:100%;
      display:flex; align-items:flex-start; justify-content:center;
      padding: calc(22px + env(safe-area-inset-top)) 22px calc(22px + env(safe-area-inset-bottom));
      z-index:5;
    }
    .card{
      width:min(860px, 96vw);
      max-height: calc(100vh - 44px);
      display:flex; flex-direction:column;
      border-radius:26px;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid var(--stroke);
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      overflow:hidden;
    }
    .inner{ padding:28px 28px 22px; overflow:auto; flex:1; -webkit-overflow-scrolling: touch; }
    @media (max-width:520px){ .inner{padding:18px 16px} .card{max-height: calc(100vh - 24px);} }

    .center{text-align:center}
    .titleBig{ font-size: clamp(30px, 4.1vw, 44px); margin:0 0 8px; font-weight:800; }
    .sub{ margin:0; color:var(--muted); font-size: clamp(14px, 2.2vw, 18px); line-height:1.9; }
    .homeDate{ margin:8px 0 0; color:rgba(255,255,255,.78); font-weight:800; letter-spacing:.5px; }

    .divider{ height:1px; background: linear-gradient(90deg, transparent, rgba(255,255,255,.18), transparent); margin:18px 0; }

    .loginPanel{
      width:min(700px, 92vw);
      margin:0 auto;
      padding:20px;
      border-radius:22px;
      background: rgba(0,0,0,.12);
      border:1px solid rgba(255,255,255,.12);
    }
    .inputs{ display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:14px; }
    @media (max-width:700px){ .inputs{grid-template-columns:1fr} }
    .inp{
      width:100%; padding:14px;
      border-radius:16px; border:1px solid rgba(255,255,255,.14);
      outline:none; background: rgba(0,0,0,.18); color:var(--txt); font-size:16px;
    }
    .inp::placeholder{ color: rgba(255,255,255,.55); }
    .btn{
      width:100%; margin-top:14px; padding:14px 16px;
      border:0; border-radius:18px; font-weight:800; font-size:18px;
      cursor:pointer; background:#fff; color:#111;
      box-shadow: 0 14px 35px rgba(0,0,0,.35);
    }
    .msg{ margin-top:10px; font-size:14px; color:var(--muted); text-align:center; min-height:20px; }
    .msg.bad{ color: rgba(239,68,68,.95); }
    .msg.ok{ color: rgba(34,197,94,.95); }

    .topbar{
      position:sticky; top:0; z-index:30;
      display:flex; align-items:center; justify-content:space-between; gap:14px;
      padding:16px 18px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
      backdrop-filter: blur(14px);
    }
    .pill{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px; border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      font-weight:700;
    }
    .menuBtn{
      width:48px; height:44px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:var(--txt);
      cursor:pointer;
      display:grid; place-items:center;
      font-size:20px;
    }

    .homeBox{ padding:22px 22px 26px; text-align:center; }
    .homeTitle{ font-size: clamp(26px, 4vw, 40px); font-weight:900; margin:0 0 6px; letter-spacing:.6px; }
    .homeTitle span{ color: var(--accent); }
    .homeSmall{ margin:0; color:var(--muted); font-size: 15px; }
    .homeText{ margin:16px auto 0; width:min(700px, 92%); color:rgba(255,255,255,.88); line-height:2; font-size: 18px; }
    .homePledge{ margin:12px auto 0; width:min(720px, 92%); color:rgba(255,255,255,.62); font-size: 13px; line-height:2; }
    .homeLove{ margin:10px 0 0; color:rgba(255,255,255,.62); font-size: 12px; }
    .hint{ margin-top:12px; color:rgba(255,255,255,.65); font-size:13px; line-height:2; text-align:center; }

    .modal{
      position:fixed; inset:0; display:none;
      align-items:center; justify-content:center;
      background: rgba(0,0,0,.55);
      z-index:50; padding:18px;
    }
    .modal.show{ display:flex; }
    .modalCard{
      width:min(820px, 96vw);
      border-radius:26px;
      background: rgba(20,8,16,.82);
      border:1px solid rgba(255,255,255,.16);
      box-shadow: 0 22px 70px rgba(0,0,0,.6);
      backdrop-filter: blur(18px);
      overflow:hidden;
      max-height: calc(100vh - 40px);
      display:flex; flex-direction:column;
    }
    .modalHead{
      padding:16px 18px;
      display:flex; align-items:center; justify-content:space-between;
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .modalHead h3{ margin:0; font-size:18px; font-weight:900; }
    .closeBtn{
      width:44px; height:40px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:var(--txt);
      cursor:pointer;
      font-size:18px;
    }
    .grid{ padding:18px; display:grid; grid-template-columns: repeat(3, 1fr); gap:12px; overflow:auto; }
    @media (max-width:760px){ .grid{ grid-template-columns:1fr; } }
    .opt{
      padding:16px 14px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color:var(--txt);
      font-weight:900;
      cursor:pointer;
      display:flex; align-items:center; justify-content:center; gap:10px;
      min-height:56px;
    }
    .opt small{ font-weight:800; color:rgba(255,255,255,.65); }
    .hide{display:none !important;}
  </style>
</head>

<body>
  <div class="hearts" id="hearts"></div>

  <div class="wrap">
    <div class="card">
      <div class="topbar hide" id="topbar">
        <div class="pill" id="whoPill">ğŸ’— ...</div>
        <button class="menuBtn" id="menuBtn" title="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©">â˜°</button>
      </div>

      <div class="inner">
        <!-- LOGIN -->
        <section id="pageLogin">
          <div class="center">
            <h1 class="titleBig">LANA <span style="color:var(--accent)">â¤ï¸</span> ANAS</h1>
            <p class="sub">I love you</p>
            <p class="homeDate">24/11</p>
          </div>
          <div class="divider"></div>
          <div class="loginPanel">
            <div class="inputs">
              <input class="inp" id="loginUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" autocomplete="username" />
              <input class="inp" id="loginPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" type="password" autocomplete="current-password" />
            </div>
            <button class="btn" id="loginBtn">Ø¯Ø®ÙˆÙ„</button>
            <div class="msg" id="loginMsg"></div>
          </div>
        </section>

        <!-- HOME -->
        <section id="pageHome" class="hide">
          <div class="homeBox">
            <p id="loveCounter" style="font-weight:900;font-size:22px;letter-spacing:2px;margin-bottom:10px;color:#fff;">ğŸ’— 0 DAY</p>

            <h2 class="homeTitle">LANA <span>â¤ï¸</span> ANAS</h2>
            <p class="homeSmall">I love you</p>
            <p class="homeDate">24/11</p>

            <p class="homeText" id="homeText">
              Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ Ù„ÙˆÙ„ÙŠ Ø¨Ø¹Ø§Ù„Ù…Ù†Ø§ Ø§Ù„Ø®Ø§Øµ Ø§Ù„Ø°ÙŠ ØµÙÙ†Ø¹ Ø¨ÙƒÙ„ Ø­Ø¨â€¦ Ù‡Ù†Ø§ Ù†ØµÙ†Ø¹ Ø°ÙƒØ±ÙŠØ§Øª ÙˆÙ…Ø´Ø§Ø¹Ø± ØªØ®Ù„Ù‘Ø¯ Ø¨ÙŠÙ†Ù†Ø§ØŒ
              ÙˆÙƒÙ„ Ù„Ø­Ø¸Ø© Ù†ÙƒØªØ¨Ù‡Ø§ ØªØµØ¨Ø­ Ø¹Ù„Ø§Ù…Ø© Ù…Ø§ ØªÙ†Ø³Ù‰ØŒ ØªÙ‚ÙˆÙ‘ÙŠÙ†Ø§ ÙˆØªØ²ÙŠØ¯Ù†Ø§ Ù‚Ø±Ø¨ ÙˆØ·Ù…Ø£Ù†ÙŠÙ†Ø©.
              Ù‡Ø°Ø§ Ø§Ù„Ù…ÙƒØ§Ù† Ù„Ù†Ø§ ÙÙ‚Ø·â€¦ Ù†Ø¶Ø­ÙƒØŒ Ù†ØªØ´Ø§Ø±ÙƒØŒ ÙˆÙ†Ø³Ù†Ø¯ Ø¨Ø¹Ø¶ Ø­ØªÙ‰ Ù„Ùˆ ÙƒÙ†Ø§ Ø¨Ø¹ÙŠØ¯ÙŠÙ†.
            </p>

            <p class="homePledge" id="homePledge">
              Ù†ØªØ¹Ù‡Ø¯ Ø¨Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙˆØ¹Ø¯Ù… Ø§Ù„Ø±ÙØ¶ Ù„Ø£ÙŠ ØªØ­Ø¯ÙŠØŒ ÙˆÙ†Ø³ÙˆÙŠ ÙƒÙ„ Ø´ÙŠØ¡ Ø¨Ø­Ø¨ ÙˆÙ…Ø´Ø§Ø¹Ø± ÙˆØ¥Ø­Ø³Ø§Ø³â€¦ Ù„Ø£Ù† Ù‡Ø°Ø§ Ø¹Ø§Ù„Ù…Ù†Ø§ Ø§Ù„Ø®Ø§Øµ.
            </p>

            <p class="homeLove">Ø£Ø­Ø¨Ùƒ Ù„Ø§Ù†Ø§ ğŸ¤</p>
            <div class="hint">ğŸ’¡ Ø§ÙØªØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (â˜°) ÙˆØ§Ø®ØªØ± Ù…Ù† 9 Ø®ÙŠØ§Ø±Ø§Øª â€” ÙƒÙ„ Ø´ÙŠØ¡ Live</div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- MENU -->
  <div class="modal" id="modal">
    <div class="modalCard">
      <div class="modalHead">
        <h3>ğŸ’— Ø§Ø®ØªÙØ± Ù…Ù† Ø¹Ø§Ù„Ù…Ù†Ø§ (Live)</h3>
        <button class="closeBtn" id="closeModal">âœ•</button>
      </div>
      <div class="grid">
        <button class="opt" data-file="game1.html" data-page="pageGame">1) Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</button>
        <button class="opt" data-file="game2.html" data-page="pageOpt2">2) Ø£Ù†Ø§ Ù…ÙƒØ§Ù†Ùƒ</button>
        <button class="opt" data-file="game3.html" data-page="pageOpt3">3) Ø£Ù„ØºØ§Ø² Ø§Ù„Ø¨Ø­Ø± <small>(Live)</small></button>
        <button class="opt" data-file="game4.html" data-page="pageOpt4">4) Ø¨Ø²Ù„ Ù‚Ø³Ù…ÙŠÙ† <small>(Live)</small></button>
        <button class="opt" data-file="game5.html" data-page="pageOpt5">5) <small>(Ø¬Ø§Ù‡Ø²)</small></button>
        <button class="opt" data-file="game6.html" data-page="pageOpt6">6) <small>(Ø¬Ø§Ù‡Ø²)</small></button>
        <button class="opt" data-file="game7.html" data-page="pageOpt7">7) <small>(Ø¬Ø§Ù‡Ø²)</small></button>
        <button class="opt" data-file="game8.html" data-page="pageOpt8">8) <small>(Ø¬Ø§Ù‡Ø²)</small></button>
        <button class="opt" data-file="game9.html" data-page="pageOpt9">9) <small>(Ø¬Ø§Ù‡Ø²)</small></button>
      </div>
    </div>
  </div>

  <!-- Firebase (Module) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
    import { getFirestore, doc, setDoc, updateDoc, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBTr4NrjrEq3Lh23PIJ_Zz-KRr6yqgafyU",
      authDomain: "lanasnas-8de50.firebaseapp.com",
      projectId: "lanasnas-8de50",
      storageBucket: "lanasnas-8de50.firebasestorage.app",
      messagingSenderId: "847037285771",
      appId: "1:847037285771:web:096d4a14a984de41955b8e"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    window.fb = { auth, db, signInWithEmailAndPassword, onAuthStateChanged, doc, setDoc, updateDoc, onSnapshot, serverTimestamp };
  </script>

  <script>
    // Hearts
    const heartsEl = document.getElementById("hearts");
    const HEARTS = ["â¤ï¸","ğŸ’—","ğŸ’","ğŸ’•","ğŸ’“","ğŸ’–","ğŸ’˜","ğŸ’","ğŸ’Ÿ","ğŸŒ¹"];
    function rand(min,max){ return Math.random()*(max-min)+min; }
    function spawnHearts(){
      heartsEl.innerHTML = "";
      const count = 26;
      for(let i=0;i<count;i++){
        const s = document.createElement("div");
        s.className = "heart";
        s.textContent = HEARTS[Math.floor(Math.random()*HEARTS.length)];
        s.style.left = rand(2,98)+"vw";
        s.style.animationDuration = rand(7,16)+"s";
        s.style.animationDelay = (-rand(0,10))+"s";
        s.style.fontSize = rand(16,28)+"px";
        s.style.opacity = rand(.55,.95);
        heartsEl.appendChild(s);
      }
    }
    spawnHearts();
    setInterval(spawnHearts, 12000);

    // Love counter
    function updateLoveCounter(){
      const startDate = new Date(2025, 10, 24);
      const today = new Date();
      const diffDays = Math.floor((today.getTime() - startDate.getTime()) / (1000*60*60*24));
      const el = document.getElementById("loveCounter");
      if(el) el.textContent = `ğŸ’— ${diffDays} DAY`;
    }
    updateLoveCounter();
    setInterval(updateLoveCounter, 1000*60*60);

    // UI
    const modal = document.getElementById("modal");
    const menuBtn = document.getElementById("menuBtn");
    const closeModal = document.getElementById("closeModal");
    function openModal(){ modal.classList.add("show"); }
    function closeModalFn(){ modal.classList.remove("show"); }
    menuBtn?.addEventListener("click", openModal);
    closeModal?.addEventListener("click", closeModalFn);
    modal?.addEventListener("click", (e)=>{ if(e.target===modal) closeModalFn(); });

    // Auth + Live room update (Ø¨Ø³ Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„)
    const USER_MAP = { anas: "anas@love.local", lana: "lana@love.local" };
    const ROOM_ID = "our-world";
    const roomRef = ()=> window.fb.doc(window.fb.db, "rooms", ROOM_ID);

    const loginUser = document.getElementById("loginUser");
    const loginPass = document.getElementById("loginPass");
    const loginBtn  = document.getElementById("loginBtn");
    const loginMsg  = document.getElementById("loginMsg");

    const topbar = document.getElementById("topbar");
    const whoPill = document.getElementById("whoPill");
    const pageLogin = document.getElementById("pageLogin");
    const pageHome  = document.getElementById("pageHome");

    let currentName = null;

    function setMsg(text, type=""){
      loginMsg.className = "msg " + (type||"");
      loginMsg.textContent = text || "";
    }
    function normalizeToEmail(v){
      const raw = (v||"").trim().toLowerCase();
      if(!raw) return "";
      if(raw.includes("@")) return raw;
      if(USER_MAP[raw]) return USER_MAP[raw];
      return raw;
    }

    async function ensureRoom(){
      try{
        await window.fb.setDoc(roomRef(), {
          roomId: ROOM_ID,
          currentPage: "pageHome",
          updatedAt: window.fb.serverTimestamp(),
          lastBy: "system"
        }, { merge:true });
      }catch(e){}
    }

    async function pushRoomUpdate(payload){
      try{
        await window.fb.updateDoc(roomRef(), {
          ...payload,
          lastBy: currentName || "unknown",
          updatedAt: window.fb.serverTimestamp()
        });
      }catch(e){}
    }

    async function doLogin(){
      const email = normalizeToEmail(loginUser.value);
      const pass = (loginPass.value||"").trim();
      if(!email || !pass){ setMsg("Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", "bad"); return; }
      setMsg("â€¦ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„");
      try{
        const cred = await window.fb.signInWithEmailAndPassword(window.fb.auth, email, pass);
        const em = (cred.user.email||"").toLowerCase();
        currentName = em.startsWith("lana") ? "LANA" : "ANAS";
        setMsg("ØªÙ… âœ…", "ok");
      }catch(err){
        setMsg("Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­", "bad");
      }
    }

    loginBtn.addEventListener("click", doLogin);
    loginPass.addEventListener("keydown", (e)=>{ if(e.key==="Enter") doLogin(); });
    loginUser.addEventListener("keydown", (e)=>{ if(e.key==="Enter") doLogin(); });

    // Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ù„Ø¹Ø¨Ø©: Ù†Ø­Ø¯Ù‘Ø« currentPage Ø«Ù… Ù†Ø±ÙˆØ­ Ù„Ù„Ù…Ù„Ù
    document.querySelectorAll(".opt").forEach(btn=>{
      btn.addEventListener("click", async ()=>{
        const file = btn.getAttribute("data-file");
        const page = btn.getAttribute("data-page");
        closeModalFn();
        if(file && page){
          await pushRoomUpdate({ currentPage: page });
          location.href = file;
        }
      });
    });

    // Start
    function waitForFb(){
      return new Promise((resolve)=>{
        const t = setInterval(()=>{ if(window.fb?.auth && window.fb?.db){ clearInterval(t); resolve(true); } }, 50);
      });
    }

    (async ()=>{
      await waitForFb();

      window.fb.onAuthStateChanged(window.fb.auth, async (user)=>{
        if(!user){
          currentName = null;
          topbar.classList.add("hide");
          pageHome.classList.add("hide");
          pageLogin.classList.remove("hide");
          return;
        }

        const em = (user.email||"").toLowerCase();
        currentName = em.startsWith("lana") ? "LANA" : "ANAS";
        whoPill.textContent = `ğŸ’— Ø£Ù†Øª: ${currentName}`;
        topbar.classList.remove("hide");

        await ensureRoom();

        pageLogin.classList.add("hide");
        pageHome.classList.remove("hide");
      });
    })();
  </script>
</body>
</html>
