<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LANA â¤ï¸ ANAS</title>
  <style>
    :root{
      --bg1:#160614;
      --bg2:#2a0b22;
      --bg3:#3a0f2d;

      --glass: rgba(255,255,255,.08);
      --glass2: rgba(255,255,255,.12);
      --stroke: rgba(255,255,255,.16);
      --txt: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --muted2: rgba(255,255,255,.55);
      --accent:#ff2d55;
      --accent2:#ff4d7d;
      --ok:#22c55e;
      --bad:#ef4444;

      --sea1:#051b2c;
      --sea2:#06354a;
      --sea3:#0b5d70;
      --seaGlow: rgba(0,210,255,.18);
      --rain: rgba(255,255,255,.22);
      --wave: rgba(255,255,255,.08);

      /* âœ… Puzzle theme */
      --puz1:#070b18;
      --puz2:#101a3a;
      --puz3:#2a1a4a;
      --puzGlow: rgba(160,140,255,.18);
      --puzDrop: rgba(255,255,255,.18);
      --puzTile: rgba(255,255,255,.07);
      --puzTile2: rgba(255,255,255,.11);
      --puzStroke: rgba(255,255,255,.14);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans Arabic", "Noto Kufi Arabic", sans-serif;
      color:var(--txt);
      overflow:hidden;
      background:
        radial-gradient(1100px 700px at 10% 10%, rgba(255,45,85,.18), transparent 60%),
        radial-gradient(900px 600px at 90% 20%, rgba(255,77,125,.16), transparent 60%),
        radial-gradient(1000px 700px at 70% 95%, rgba(255,45,85,.14), transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2), var(--bg3));
      transition: background .35s ease;
    }

    /* subtle blur overlay */
    .vignette{
      position:fixed; inset:0;
      pointer-events:none;
      background: radial-gradient(900px 600px at 50% 0%, rgba(255,255,255,.06), transparent 60%),
                  radial-gradient(900px 700px at 50% 100%, rgba(0,0,0,.35), transparent 55%);
      mix-blend-mode: screen;
    }

    /* hearts rain (default) */
    .hearts{
      position:fixed; inset:-20vh 0 0 0;
      pointer-events:none;
      overflow:hidden;
      filter: drop-shadow(0 8px 18px rgba(0,0,0,.35));
      transition: opacity .25s ease;
      z-index:2;
    }
    .heart{
      position:absolute;
      top:-20vh;
      font-size:22px;
      opacity:.95;
      animation: fall linear infinite;
      will-change: transform;
      text-shadow: 0 12px 24px rgba(0,0,0,.35);
    }
    @keyframes fall{
      to{ transform: translateY(130vh) rotate(25deg); }
    }

    /* ===== OPTION 3 SEA + RAIN THEME (Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ù…Ø±Ø¨Ø¹Ø§Øª) ===== */
    body.seaTheme{
      background:
        radial-gradient(1100px 700px at 20% 10%, var(--seaGlow), transparent 60%),
        radial-gradient(900px 600px at 80% 20%, rgba(0,210,255,.12), transparent 60%),
        radial-gradient(1000px 700px at 60% 95%, rgba(0,150,255,.10), transparent 55%),
        linear-gradient(135deg, var(--sea1), var(--sea2), var(--sea3));
    }
    body.seaTheme .hearts{ opacity:.12; }

    .rain{
      position:fixed; inset:-20vh 0 0 0;
      pointer-events:none;
      overflow:hidden;
      display:none;
      opacity:0;
      transition: opacity .25s ease;
      filter: drop-shadow(0 14px 25px rgba(0,0,0,.35));
      z-index:1;
    }
    body.seaTheme .rain{
      display:block;
      opacity:1;
    }
    .drop{
      position:absolute;
      top:-25vh;
      width:2px;
      height:18px;
      background: linear-gradient(to bottom, rgba(255,255,255,0), var(--rain), rgba(255,255,255,0));
      border-radius:999px;
      animation: rainFall linear infinite;
      will-change: transform;
      opacity:.7;
    }
    @keyframes rainFall{
      to{ transform: translateY(140vh) translateX(6vw); }
    }

    /* âœ… NEW: Emoji rain for Option 3 (ğŸŸâ¤ï¸â“) */
    .seaEmojis{
      position:fixed; inset:-22vh 0 0 0;
      pointer-events:none;
      overflow:hidden;
      display:none;
      opacity:0;
      transition: opacity .25s ease;
      filter: drop-shadow(0 14px 25px rgba(0,0,0,.35));
      z-index:3;
    }
    body.seaTheme .seaEmojis{
      display:block;
      opacity:1;
    }
    .seaEmoji{
      position:absolute;
      top:-25vh;
      font-size:22px;
      opacity:.95;
      animation: emojiFall linear infinite;
      will-change: transform;
      text-shadow: 0 12px 24px rgba(0,0,0,.35);
    }
    @keyframes emojiFall{
      to{ transform: translateY(140vh) translateX(8vw) rotate(25deg); }
    }

    /* waves overlay (visual only) */
    .waves{
      position:fixed; left:0; right:0; bottom:-12vh; height:40vh;
      pointer-events:none;
      display:none;
      opacity:0;
      transition: opacity .25s ease;
      background:
        radial-gradient(60% 70% at 10% 40%, rgba(255,255,255,.08), transparent 60%),
        radial-gradient(55% 65% at 35% 55%, rgba(255,255,255,.06), transparent 60%),
        radial-gradient(60% 70% at 65% 45%, rgba(255,255,255,.07), transparent 60%),
        radial-gradient(55% 65% at 90% 55%, rgba(255,255,255,.06), transparent 60%);
      filter: blur(8px);
      mix-blend-mode: screen;
      animation: waveMove 7s ease-in-out infinite;
      z-index:1;
    }
    @keyframes waveMove{
      0%{ transform: translateY(0) translateX(0); }
      50%{ transform: translateY(-10px) translateX(-12px); }
      100%{ transform: translateY(0) translateX(0); }
    }
    body.seaTheme .waves{
      display:block;
      opacity:1;
    }

    /* âœ… PUZZLE THEME (Option 4) */
    body.puzzleTheme{
      background:
        radial-gradient(950px 620px at 15% 10%, var(--puzGlow), transparent 62%),
        radial-gradient(900px 600px at 85% 22%, rgba(110,230,255,.10), transparent 62%),
        radial-gradient(1000px 700px at 65% 96%, rgba(255,90,190,.10), transparent 58%),
        linear-gradient(135deg, var(--puz1), var(--puz2), var(--puz3));
    }
    body.puzzleTheme .hearts{ opacity:.10; }
    body.puzzleTheme .rain{ opacity:0; display:none; }
    body.puzzleTheme .seaEmojis{ opacity:0; display:none; }
    body.puzzleTheme .waves{ opacity:0; display:none; }

    .puzzleRain{
      position:fixed; inset:-20vh 0 0 0;
      pointer-events:none;
      overflow:hidden;
      display:none;
      opacity:0;
      transition: opacity .25s ease;
      filter: drop-shadow(0 14px 25px rgba(0,0,0,.35));
      z-index:1;
    }
    body.puzzleTheme .puzzleRain{
      display:block;
      opacity:1;
    }
    .puzDrop{
      position:absolute;
      top:-25vh;
      width:16px;
      height:16px;
      border-radius:6px;
      background:
        radial-gradient(12px 12px at 30% 30%, rgba(255,255,255,.18), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.16), rgba(255,255,255,.06));
      border:1px solid rgba(255,255,255,.12);
      animation: puzFall linear infinite;
      will-change: transform;
      opacity:.65;
      transform: rotate(15deg);
      box-shadow: 0 10px 25px rgba(0,0,0,.20);
    }
    /* â€œÙ†ØªÙˆØ¡â€ Ø¨Ø³ÙŠØ· ÙŠØ¹Ø·ÙŠ Ø¥Ø­Ø³Ø§Ø³ Ù‚Ø·Ø¹Ø© Ø¨Ø²Ù„ */
    .puzDrop::after{
      content:"";
      position:absolute;
      width:6px; height:6px;
      border-radius:999px;
      left:50%; top:-3px;
      transform: translateX(-50%);
      background: rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.10);
      filter: blur(.2px);
    }
    @keyframes puzFall{
      to{ transform: translateY(145vh) translateX(8vw) rotate(120deg); }
    }

    /* layout */
    .wrap{
      position:relative;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:22px;
      z-index:5;
    }

    .card{
      width:min(860px, 96vw);
      border-radius:26px;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid var(--stroke);
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      overflow:hidden;
    }

    .inner{
      padding:28px 28px 22px;
    }

    .center{text-align:center}

    .titleBig{
      font-size: clamp(30px, 4.1vw, 44px);
      letter-spacing:.5px;
      margin:0 0 8px;
      font-weight:800;
    }
    .sub{
      margin:0;
      color:var(--muted);
      font-size: clamp(14px, 2.2vw, 18px);
      line-height:1.9;
    }

    .divider{
      height:1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.18), transparent);
      margin:18px 0;
    }

    /* login panel */
    .loginPanel{
      width:min(700px, 92vw);
      margin:0 auto;
      padding:20px;
      border-radius:22px;
      background: rgba(0,0,0,.12);
      border:1px solid rgba(255,255,255,.12);
    }
    .inputs{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:14px;
    }
    @media (max-width:700px){
      .inputs{ grid-template-columns:1fr; }
    }
    .inp{
      width:100%;
      padding:14px 14px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      outline:none;
      background: rgba(0,0,0,.18);
      color:var(--txt);
      font-size:16px;
    }
    .inp::placeholder{ color: rgba(255,255,255,.55); }
    .btn{
      width:100%;
      margin-top:14px;
      padding:14px 16px;
      border:0;
      border-radius:18px;
      font-weight:800;
      font-size:18px;
      cursor:pointer;
      background: #ffffff;
      color:#111;
      box-shadow: 0 14px 35px rgba(0,0,0,.35);
    }
    .btn:active{ transform: translateY(1px); }

    .msg{
      margin-top:10px;
      font-size:14px;
      color:var(--muted);
      text-align:center;
      min-height:20px;
    }
    .msg.bad{ color: rgba(239,68,68,.95); }
    .msg.ok{ color: rgba(34,197,94,.95); }

    /* top bar */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      padding:16px 18px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.10);
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:var(--txt);
      font-weight:700;
      max-width: 62vw;
      overflow:hidden;
      text-overflow: ellipsis;
      white-space:nowrap;
    }
    .leftGroup,.rightGroup{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .menuBtn{
      width:48px; height:44px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:var(--txt);
      cursor:pointer;
      display:grid;
      place-items:center;
      font-size:20px;
    }

    .select{
      padding:10px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color:var(--txt);
      outline:none;
      font-weight:800;
    }

    /* pages */
    .page{ display:none; }
    .page.active{ display:block; }

    /* home content */
    .homeBox{
      padding:22px 22px 26px;
      text-align:center;
    }
    .homeTitle{
      font-size: clamp(26px, 4vw, 40px);
      font-weight:900;
      margin:0 0 6px;
      letter-spacing:.6px;
    }
    .homeTitle span{
      color: var(--accent);
      text-shadow: 0 10px 24px rgba(255,45,85,.22);
    }
    .homeSmall{ margin:0; color:var(--muted); font-size: 15px; }
    .homeDate{
      margin:8px 0 0;
      color:rgba(255,255,255,.78);
      font-weight:800;
      letter-spacing:.5px;
    }
    .homeText{
      margin:16px auto 0;
      width:min(700px, 92%);
      color:rgba(255,255,255,.88);
      line-height:2;
      font-size: 18px;
    }
    .homePledge{
      margin:12px auto 0;
      width:min(720px, 92%);
      color:rgba(255,255,255,.62);
      font-size: 13px;
      line-height:2;
    }
    .homeLove{
      margin:10px 0 0;
      color:rgba(255,255,255,.62);
      font-size: 12px;
    }

    /* modal menu */
    .modal{
      position:fixed; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background: rgba(0,0,0,.55);
      z-index:50;
      padding:18px;
    }
    .modal.show{ display:flex; }
    .modalCard{
      width:min(820px, 96vw);
      border-radius:26px;
      background: rgba(20,8,16,.82);
      border:1px solid rgba(255,255,255,.16);
      box-shadow: 0 22px 70px rgba(0,0,0,.6);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      overflow:hidden;
    }
    .modalHead{
      padding:16px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .modalHead h3{
      margin:0;
      font-size:18px;
      font-weight:900;
      color:rgba(255,255,255,.92);
    }
    .closeBtn{
      width:44px; height:40px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:var(--txt);
      cursor:pointer;
      font-size:18px;
    }
    .grid{
      padding:18px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:12px;
    }
    @media (max-width:760px){
      .grid{ grid-template-columns:1fr; }
    }
    .opt{
      padding:16px 14px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color:var(--txt);
      font-weight:900;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      min-height:56px;
      transition: transform .12s ease, background .12s ease;
    }
    .opt:hover{ transform: translateY(-1px); background: rgba(255,255,255,.09); }
    .opt small{ font-weight:800; color:rgba(255,255,255,.65); }

    /* generic content box (for future games) */
    .contentBox{
      padding:18px 18px 24px;
    }
    .backBtn{
      padding:10px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:var(--txt);
      cursor:pointer;
      font-weight:900;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .hint{
      margin-top:12px;
      color:rgba(255,255,255,.65);
      font-size:13px;
      line-height:2;
      text-align:center;
    }

    /* game page */
    .gameBox{ padding:18px 18px 24px; }
    .gameTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:12px;
    }
    .promptCard{
      margin-top:12px;
      border-radius:22px;
      background: rgba(0,0,0,.16);
      border:1px solid rgba(255,255,255,.14);
      padding:18px;
      min-height:120px;
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      font-size:22px;
      line-height:1.8;
    }
    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
    }
    .actionBtn{
      flex:1 1 160px;
      padding:12px 14px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:var(--txt);
      cursor:pointer;
      font-weight:900;
    }
    .statusLine{
      margin-top:10px;
      color:rgba(255,255,255,.55);
      font-size:13px;
      text-align:center;
    }

    /* ===== OPTION 2: "Ø£Ù†Ø§ Ù…ÙƒØ§Ù†Ùƒ" ===== */
    .amkWrap{ margin-top:12px; }
    .amkQ{
      margin:12px 0 0;
      border-radius:22px;
      background: rgba(0,0,0,.16);
      border:1px solid rgba(255,255,255,.14);
      padding:16px 14px;
      text-align:center;
      font-size:20px;
      line-height:1.9;
    }
    .amkGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:12px;
    }
    @media (max-width:760px){
      .amkGrid{ grid-template-columns:1fr; }
    }
    .amkCard{
      border-radius:22px;
      background: rgba(0,0,0,.14);
      border:1px solid rgba(255,255,255,.12);
      padding:14px;
    }
    .amkHead{
      font-weight:900;
      margin-bottom:10px;
      color:rgba(255,255,255,.90);
      text-align:center;
      line-height:1.8;
    }
    .amkArea{
      width:100%;
      min-height:120px;
      resize:vertical;
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      outline:none;
      background: rgba(0,0,0,.18);
      color:var(--txt);
      font-size:16px;
      line-height:1.9;
    }
    .amkArea::placeholder{ color: rgba(255,255,255,.55); }
    .amkRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
    }
    .amkRow .actionBtn{ flex:1 1 180px; }

    /* ===== OPTION 3: Ø§Ø­Ù†Ø§ Ø£Ù‚ÙˆÙ‰ Ù…Ù† Ø§Ù„Ø³Ù…ÙƒØ© ===== */
    .fishWrap{ margin-top:12px; }
    .fishTopRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-top:10px;
    }
    .fishBadge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:var(--txt);
      font-weight:900;
      max-width: 92%;
      overflow:hidden;
      text-overflow: ellipsis;
      white-space:nowrap;
    }
    .fishCard{
      margin-top:12px;
      border-radius:22px;
      background: rgba(0,0,0,.16);
      border:1px solid rgba(255,255,255,.14);
      padding:16px 14px;
      text-align:center;
      line-height:1.9;
      position:relative;
      overflow:hidden;
    }
    body.seaTheme .fishCard{
      background: rgba(0,10,18,.20);
      border-color: rgba(255,255,255,.18);
    }
    .fishCard::after{
      content:"";
      position:absolute; inset:-20%;
      background:
        radial-gradient(40% 30% at 30% 35%, rgba(255,255,255,.08), transparent 60%),
        radial-gradient(35% 30% at 70% 55%, rgba(255,255,255,.06), transparent 60%);
      opacity:0;
      transition: opacity .25s ease;
      pointer-events:none;
    }
    body.seaTheme .fishCard::after{ opacity:1; }

    .fishQ{
      font-size:20px;
      font-weight:900;
      margin:0;
      position:relative;
      z-index:1;
    }
    .fishChoices{
      margin-top:12px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      position:relative;
      z-index:1;
    }
    @media (max-width:760px){
      .fishChoices{ grid-template-columns:1fr; }
    }
    .fishChoiceBtn{
      padding:14px 14px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color:var(--txt);
      cursor:pointer;
      font-weight:900;
      text-align:center;
      line-height:1.8;
      min-height:56px;
      transition: transform .12s ease, background .12s ease;
    }
    .fishChoiceBtn:hover{ transform: translateY(-1px); background: rgba(255,255,255,.10); }
    .fishChoiceBtn.disabled{
      opacity:.55;
      cursor:not-allowed;
      transform:none !important;
    }

    .fishResult{
      margin-top:12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.12);
      padding:12px 12px;
      text-align:center;
      color:rgba(255,255,255,.88);
      white-space:pre-wrap;
      line-height:2;
      min-height:48px;
      position:relative;
      z-index:1;
    }
    .fishLove{
      margin-top:12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,45,85,.10);
      padding:12px 12px;
      text-align:center;
      color:rgba(255,255,255,.92);
      white-space:pre-wrap;
      line-height:2;
      display:none;
      position:relative;
      z-index:1;
    }
    .fishLove.show{ display:block; }

    .fishActions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
      position:relative;
      z-index:1;
    }
    .fishActions .actionBtn{ flex:1 1 160px; }

    .confirmLine{
      margin-top:10px;
      color:rgba(255,255,255,.72);
      font-size:12px;
      text-align:center;
      line-height:1.9;
      position:relative;
      z-index:1;
    }

    .hide{ display:none !important; }

    /* âœ… OPTION 4: PUZZLE (Mobile-first) */
    .puzWrap{ margin-top:12px; }
    .puzTopRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-top:10px;
    }
    .puzBadge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color:var(--txt);
      font-weight:900;
      max-width: 100%;
      overflow:hidden;
      text-overflow: ellipsis;
      white-space:nowrap;
    }
    .puzCard{
      margin-top:12px;
      border-radius:22px;
      background: rgba(0,0,0,.16);
      border:1px solid rgba(255,255,255,.14);
      padding:14px;
      position:relative;
      overflow:hidden;
    }
    body.puzzleTheme .puzCard{
      background: rgba(5,8,18,.18);
      border-color: rgba(255,255,255,.16);
    }

    .puzLayout{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
    }

    .puzPanel{
      border-radius:18px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      padding:12px;
    }
    .puzPanelTitle{
      font-weight:900;
      margin:0 0 10px;
      color:rgba(255,255,255,.92);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .puzMini{
      font-size:12px;
      color:rgba(255,255,255,.70);
      font-weight:800;
    }

    /* phone-friendly image box */
    .puzImageBox{
      width:100%;
      aspect-ratio: 1 / 1;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.14);
      overflow:hidden;
      background: rgba(0,0,0,.15);
      position:relative;
    }
    .puzImageBox img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
      user-select:none;
      -webkit-user-drag:none;
      pointer-events:none;
    }
    .puzImageGlow{
      position:absolute; inset:0;
      background:
        radial-gradient(60% 55% at 30% 25%, rgba(255,255,255,.10), transparent 62%),
        radial-gradient(55% 55% at 70% 75%, rgba(255,255,255,.08), transparent 62%);
      mix-blend-mode: screen;
      pointer-events:none;
      opacity:.9;
    }

    /* board */
    .puzBoard{
      width:100%;
      aspect-ratio: 1 / 1;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.12);
      padding:10px;
      display:grid;
      gap:8px;
    }
    body.puzzleTheme .puzBoard{
      background: rgba(0,0,0,.10);
    }
    .puzSlot{
      border-radius:14px;
      border:1px dashed rgba(255,255,255,.18);
      background: rgba(255,255,255,.04);
      position:relative;
      overflow:hidden;
      display:grid;
      place-items:center;
      min-height:0;
      user-select:none;
      -webkit-user-select:none;
      touch-action: manipulation;
    }
    .puzSlot.filled{
      border-style:solid;
      border-color: rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
    }

    /* piece visual (no canvas slicing: background-position trick) */
    .puzPiece{
      width:100%;
      height:100%;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background-repeat:no-repeat;
      background-size: 100% 100%;
      box-shadow: 0 10px 25px rgba(0,0,0,.22);
      position:relative;
      overflow:hidden;
      touch-action: manipulation;
    }
    .puzPiece::after{
      content:"";
      position:absolute; inset:-20%;
      background:
        radial-gradient(40% 30% at 30% 25%, rgba(255,255,255,.10), transparent 60%),
        radial-gradient(40% 30% at 70% 75%, rgba(255,255,255,.08), transparent 60%);
      opacity:.7;
      pointer-events:none;
    }

    .puzTray{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      justify-content:center;
    }
    .puzTile{
      width:60px;
      aspect-ratio: 1/1;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      overflow:hidden;
      cursor:pointer;
      position:relative;
      user-select:none;
      -webkit-user-select:none;
      touch-action: manipulation;
      box-shadow: 0 12px 28px rgba(0,0,0,.22);
    }
    @media (max-width:520px){
      .puzTile{ width:56px; }
    }
    .puzTile.selected{
      outline: 2px solid rgba(255,255,255,.85);
      transform: translateY(-1px);
    }
    .puzTile .puzPiece{ border-radius:13px; border:0; box-shadow:none; }

    .puzStatus{
      margin-top:10px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.10);
      padding:10px 12px;
      color:rgba(255,255,255,.85);
      white-space:pre-wrap;
      line-height:2;
      font-size:13px;
      text-align:center;
    }
    .puzSuccess{
      margin-top:10px;
      border-radius:16px;
      border:1px solid rgba(34,197,94,.30);
      background: rgba(34,197,94,.10);
      padding:10px 12px;
      color:rgba(255,255,255,.92);
      white-space:pre-wrap;
      line-height:2;
      font-size:13px;
      text-align:center;
      display:none;
    }
    .puzSuccess.show{ display:block; }
  </style>
</head>

<body>
  <div class="hearts" id="hearts"></div>
  <div class="rain" id="rain"></div>

  <!-- âœ… NEW: Emoji rain layer for stage 3 -->
  <div class="seaEmojis" id="seaEmojis"></div>

  <!-- âœ… NEW: Puzzle-piece rain layer for option 4 -->
  <div class="puzzleRain" id="puzzleRain"></div>

  <div class="waves"></div>
  <div class="vignette"></div>

  <div class="wrap">
    <div class="card">
      <!-- TOPBAR (Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„) -->
      <div class="topbar hide" id="topbar">
        <div class="leftGroup">
          <div class="pill" id="whoPill">ğŸ’— ...</div>
        </div>
        <div class="rightGroup">
          <button class="menuBtn" id="menuBtn" title="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Live)">â˜°</button>
        </div>
      </div>

      <div class="inner">
        <!-- LOGIN PAGE -->
        <section class="page active" id="pageLogin">
          <div class="center">
            <h1 class="titleBig">LANA <span style="color:var(--accent)">â¤ï¸</span> ANAS</h1>
            <p class="sub">I love you</p>
            <p class="homeDate">24/11</p>
          </div>

          <div class="divider"></div>

          <div class="loginPanel">
            <div class="inputs">
              <input class="inp" id="loginUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" autocomplete="username" />
              <input class="inp" id="loginPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" type="password" autocomplete="current-password" />
            </div>
            <button class="btn" id="loginBtn">Ø¯Ø®ÙˆÙ„</button>
            <div class="msg" id="loginMsg"></div>
          </div>
        </section>

        <!-- HOME PAGE -->
        <section class="page" id="pageHome">
          <div class="homeBox">
            <p id="loveCounter" style="
              font-weight:900;
              font-size:22px;
              letter-spacing:2px;
              margin-bottom:10px;
              color:#fff;
            ">ğŸ’— 0 DAY</p>

            <h2 class="homeTitle">LANA <span>â¤ï¸</span> ANAS</h2>
            <p class="homeSmall">I love you</p>
            <p class="homeDate">24/11</p>

            <p class="homeText" id="homeText">
              Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ Ù„ÙˆÙ„ÙŠ Ø¨Ø¹Ø§Ù„Ù…Ù†Ø§ Ø§Ù„Ø®Ø§Øµ Ø§Ù„Ø°ÙŠ ØµÙÙ†Ø¹ Ø¨ÙƒÙ„ Ø­Ø¨â€¦ Ù‡Ù†Ø§ Ù†ØµÙ†Ø¹ Ø°ÙƒØ±ÙŠØ§Øª ÙˆÙ…Ø´Ø§Ø¹Ø± ØªØ®Ù„Ù‘Ø¯ Ø¨ÙŠÙ†Ù†Ø§ØŒ
              ÙˆÙƒÙ„ Ù„Ø­Ø¸Ø© Ù†ÙƒØªØ¨Ù‡Ø§ ØªØµØ¨Ø­ Ø¹Ù„Ø§Ù…Ø© Ù…Ø§ ØªÙ†Ø³Ù‰ØŒ ØªÙ‚ÙˆÙ‘ÙŠÙ†Ø§ ÙˆØªØ²ÙŠØ¯Ù†Ø§ Ù‚Ø±Ø¨ ÙˆØ·Ù…Ø£Ù†ÙŠÙ†Ø©.
              Ù‡Ø°Ø§ Ø§Ù„Ù…ÙƒØ§Ù† Ù„Ù†Ø§ ÙÙ‚Ø·â€¦ Ù†Ø¶Ø­ÙƒØŒ Ù†ØªØ´Ø§Ø±ÙƒØŒ ÙˆÙ†Ø³Ù†Ø¯ Ø¨Ø¹Ø¶ Ø­ØªÙ‰ Ù„Ùˆ ÙƒÙ†Ø§ Ø¨Ø¹ÙŠØ¯ÙŠÙ†.
            </p>

            <p class="homePledge" id="homePledge">
              Ù†ØªØ¹Ù‡Ø¯ Ø¨Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙˆØ¹Ø¯Ù… Ø§Ù„Ø±ÙØ¶ Ù„Ø£ÙŠ ØªØ­Ø¯ÙŠØŒ ÙˆÙ†Ø³ÙˆÙŠ ÙƒÙ„ Ø´ÙŠØ¡ Ø¨Ø­Ø¨ ÙˆÙ…Ø´Ø§Ø¹Ø± ÙˆØ¥Ø­Ø³Ø§Ø³â€¦ Ù„Ø£Ù† Ù‡Ø°Ø§ Ø¹Ø§Ù„Ù…Ù†Ø§ Ø§Ù„Ø®Ø§Øµ.
            </p>

            <p class="homeLove">Ø£Ø­Ø¨Ùƒ Ù„Ø§Ù†Ø§ ğŸ¤</p>

            <div class="hint">ğŸ’¡ Ø§ÙØªØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (â˜°) Ù…Ù† ÙÙˆÙ‚ ÙˆØ§Ø®ØªØ± Ù…Ù† 9 Ø®ÙŠØ§Ø±Ø§Øª â€” ÙƒÙ„ Ø´ÙŠØ¡ ÙŠØªØ²Ø§Ù…Ù† Ø¨ÙŠÙ†ÙƒÙ… Live</div>
          </div>
        </section>

        <!-- OPTION 1: GAME (Love Questions) -->
        <section class="page" id="pageGame">
          <div class="gameBox">
            <div class="gameTop">
              <button class="backBtn" id="backHomeBtn">â†© Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>

              <select class="select" id="modeSelect" title="ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø±Ø­Ù„Ø© (Live)">
                <option value="lana1">LANA 1</option>
                <option value="lana2">LANA 2</option>
                <option value="lana3">LANA 3</option>
                <option value="lana4">LANA 4</option>
              </select>

              <div class="pill" id="roomPill">Room: our-world</div>
            </div>

            <div class="promptCard" id="promptCard">Ø§Ø¨Ø¯Ø£ âœ¨ Ø§Ø®ØªØ± (Ø³Ø¤Ø§Ù„ / ØªØ­Ø¯ÙŠ)</div>

            <div class="actions">
              <button class="actionBtn" id="btnQ">ğŸ’— Ø³Ø¤Ø§Ù„</button>
              <button class="actionBtn" id="btnC">ğŸ”¥ ØªØ­Ø¯ÙŠ</button>
            </div>

            <div class="statusLine" id="syncLine">â€¦</div>
          </div>
        </section>

        <!-- OPTION 2 -->
        <section class="page" id="pageOpt2">
          <div class="contentBox">
            <button class="backBtn backAny">ğŸ  Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>

            <div class="promptCard" style="font-size:20px">ğŸ’¥ Ù„Ø¹Ø¨Ø© â€œØ£Ù†Ø§ Ù…ÙƒØ§Ù†Ùƒâ€</div>

            <div class="amkWrap">
              <div class="amkQ" id="amkQuestion">â€¦</div>

              <div class="amkGrid">
                <div class="amkCard">
                  <div class="amkHead">Ø£Ù†Ø§ Ø£Ø¬Ø§ÙˆØ¨ ÙƒØ£Ù†ÙŠ: <b id="amkMeAs">â€¦</b></div>
                  <textarea class="amkArea" id="amkMe" placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ù‡Ù†Ø§â€¦"></textarea>
                  <button class="actionBtn" id="amkSave">ğŸ’¾ Ø­ÙØ¸ Ø¥Ø¬Ø§Ø¨ØªÙŠ (Live)</button>
                  <div class="hint" id="amkHintMe"></div>
                </div>

                <div class="amkCard">
                  <div class="amkHead">Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ ÙŠØ¬Ø§ÙˆØ¨ ÙƒØ£Ù†Ù‡: <b id="amkOtherAs">â€¦</b></div>
                  <textarea class="amkArea" id="amkOther" placeholder="ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨Ø¹Ø¯ Ù…Ø§ ÙŠØ­ÙØ¸..." readonly></textarea>
                  <div class="hint" id="amkHintOther"></div>
                </div>
              </div>

              <div class="amkRow">
                <button class="actionBtn" id="amkNew">ğŸŒ¹ Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯</button>
              </div>

              <div class="statusLine" id="amkStatus">â€¦</div>
            </div>
          </div>
        </section>

        <!-- OPTION 3: Ø§Ø­Ù†Ø§ Ø£Ù‚ÙˆÙ‰ Ù…Ù† Ø§Ù„Ø³Ù…ÙƒØ© -->
        <section class="page" id="pageOpt3">
          <div class="contentBox">
            <button class="backBtn backAny">ğŸ  Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø±Ø¦ÙŠØ³ÙŠØ©</button>

            <div class="promptCard" style="font-size:20px">ğŸŒ§ï¸ğŸŒŠ Ø£Ù„ØºØ§Ø² Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø­Ø±: Ø§Ø­Ù†Ø§ Ø£Ù‚ÙˆÙ‰ Ù…Ù† Ø§Ù„Ø³Ù…ÙƒØ© â“ğŸŸâ¤ï¸</div>

            <div class="fishWrap">
              <div class="fishTopRow">
                <div class="fishBadge" id="fishStageBadge">Ø§Ù„Ù…Ø±Ø­Ù„Ø©: 1 / 150</div>
                <button class="actionBtn" id="fishPunishBtn">âš ï¸ Ø¹Ù‚Ø§Ø¨ (Ø¹Ø´ÙˆØ§Ø¦ÙŠ)</button>
              </div>

              <div class="fishCard">
                <p class="fishQ" id="fishQ">â€¦</p>

                <div class="fishChoices">
                  <button class="fishChoiceBtn" id="fishC0">â€¦</button>
                  <button class="fishChoiceBtn" id="fishC1">â€¦</button>
                  <button class="fishChoiceBtn" id="fishC2">â€¦</button>
                  <button class="fishChoiceBtn" id="fishC3">â€¦</button>
                </div>

                <div class="fishResult" id="fishResult">Ø§Ø®ØªØ§Ø±ÙˆØ§ Ø¬ÙˆØ§Ø¨ Ù…Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ğŸ‘† (Live)</div>
                <div class="fishLove" id="fishLove">â€¦</div>

                <div class="fishActions">
                  <button class="actionBtn" id="fishConfirmBtn">âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¬ÙˆØ§Ø¨ (Ù„Ø§Ø²Ù… Ø§Ù„Ø§Ø«Ù†ÙŠÙ†)</button>
                  <button class="actionBtn hide" id="fishNextBtn">â¡ï¸ Ø§Ù„ØªØ§Ù„ÙŠ</button>
                </div>

                <div class="confirmLine" id="fishConfirmLine">â€¦</div>

                <div class="statusLine" id="fishStatus">â€¦</div>
              </div>

              <div class="hint">
                âœ… Ø£ÙŠ ÙˆØ§Ø­Ø¯ ÙŠØ®ØªØ§Ø± â†’ ÙŠØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø«Ø§Ù†ÙŠ Live<br/>
                ğŸ”’ Ù…Ø§ ØªØ·Ù„Ø¹ Ù†ØªÙŠØ¬Ø© ØµØ­/ØºÙ„Ø· Ø¥Ù„Ø§ Ø¥Ø°Ø§ **Ø£Ù†ØªÙ… Ø§Ù„Ø§Ø«Ù†ÙŠÙ†** Ø¶ØºØ·ØªÙ… (ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¬ÙˆØ§Ø¨)<br/>
                âœ… Ø¥Ø°Ø§ Ø·Ù„Ø¹Øª ØµØ­: ÙŠÙƒØªØ¨ (ØªØ®Ø³ÙŠ Ø§Ù„Ø³Ù…ÙƒØ© Ø§Ø­Ù†Ø§ Ø§Ù‚ÙˆÙ‰) ÙˆÙŠÙ†Ù‚Ù„ÙƒÙ… ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù„ÙŠ Ø¨Ø¹Ø¯Ù‡Ø§
              </div>
            </div>
          </div>
        </section>

        <!-- âœ… OPTION 4: PUZZLE 200 (Live Roles) -->
        <section class="page" id="pageOpt4">
          <div class="contentBox">
            <button class="backBtn backAny">ğŸ  Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>

            <div class="promptCard" style="font-size:20px">ğŸ§© Ø¨Ø²Ù„ 200 Ù…Ø±Ø­Ù„Ø© â€” ÙˆØ§Ø­Ø¯ ÙŠØ´ÙˆÙ ÙƒØ§Ù…Ù„ ÙˆØ§Ù„Ø«Ø§Ù†ÙŠ ÙŠØ±ÙƒÙ‘Ø¨ (Live)</div>

            <div class="puzWrap">
              <div class="puzTopRow">
                <div class="puzBadge" id="puzStageBadge">Ø§Ù„Ù…Ø±Ø­Ù„Ø©: 1 / 200</div>
                <div class="puzBadge" id="puzRoleBadge">Ø§Ù„Ø¯ÙˆØ±: â€¦</div>
              </div>

              <div class="puzTopRow">
                <button class="actionBtn" id="puzSwapBtn">ğŸ” ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± (Live)</button>
                <button class="actionBtn" id="puzResetBtn">ğŸ§¹ ØªØµÙÙŠØ± Ø§Ù„Ù…Ø±Ø­Ù„Ø©</button>
                <button class="actionBtn" id="puzNextBtn" disabled>â¡ï¸ Ø§Ù„ØªØ§Ù„ÙŠ</button>
              </div>

              <div class="puzCard">
                <div class="puzLayout">
                  <!-- Viewer Panel -->
                  <div class="puzPanel" id="puzViewerPanel">
                    <div class="puzPanelTitle">
                      <span>ğŸ‘ï¸ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</span>
                      <span class="puzMini" id="puzViewerMini">â€¦</span>
                    </div>
                    <div class="puzImageBox">
                      <img id="puzFullImg" alt="puzzle" />
                      <div class="puzImageGlow"></div>
                    </div>
                    <div class="hint" id="puzViewerHint">Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… ÙŠØ¸Ù‡Ø± Ù„Ù„Ø´Ø®Øµ â€œØ§Ù„Ù…Ø´Ø§Ù‡Ø¯â€ ÙÙ‚Ø·.</div>
                  </div>

                  <!-- Assembler Panel -->
                  <div class="puzPanel" id="puzAssemblerPanel">
                    <div class="puzPanelTitle">
                      <span>ğŸ§© Ø§Ù„ØªØ±ÙƒÙŠØ¨</span>
                      <span class="puzMini" id="puzAssemblerMini">â€¦</span>
                    </div>

                    <div class="puzBoard" id="puzBoard"></div>

                    <div class="hint">ğŸ“Œ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©: Ø§Ø¶ØºØ· Ù‚Ø·Ø¹Ø© Ù…Ù† ØªØ­Øª â†’ Ø«Ù… Ø§Ø¶ØºØ· Ù…ÙƒØ§Ù† ÙØ§Ø¶ÙŠ ÙÙŠ Ø§Ù„Ù„ÙˆØ­. Ù„Ø¥Ø²Ø§Ù„Ø© Ù‚Ø·Ø¹Ø©: Ø§Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡Ø§ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù„ÙˆØ­.</div>

                    <div class="divider" style="margin:14px 0;"></div>

                    <div class="puzTray" id="puzTray"></div>

                    <div class="puzSuccess" id="puzSuccess">âœ… Ø¨Ø±Ø§ÙÙˆ! Ø®Ù„ØµØªÙˆØ§ Ø§Ù„Ù…Ø±Ø­Ù„Ø© ğŸ’—</div>
                    <div class="puzStatus" id="puzStatus">â€¦</div>
                  </div>
                </div>
              </div>

              <div class="hint">
                ğŸ”¥ Live Ø¨Ø§Ù„ÙƒØ§Ù…Ù„: ÙƒÙ„ Ø­Ø±ÙƒØ© ØªØ¸Ù‡Ø± Ù„Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ ÙÙˆØ±Ù‹Ø§<br/>
                ğŸ‘ï¸ ÙˆØ§Ø­Ø¯ ÙŠØ´ÙˆÙ Ø§Ù„ØµÙˆØ±Ø© ÙƒØ§Ù…Ù„Ø©ØŒ ÙˆØ§Ù„Ø«Ø§Ù†ÙŠ ÙŠØ±ÙƒÙ‘Ø¨ â€” ÙˆØªÙ‚Ø¯Ø±ÙˆÙ† ØªØ¨Ø¯Ù„ÙˆÙ† Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª<br/>
                â›” Ø¨Ø¯ÙˆÙ† Ù…Ø¤Ù‚Øª
              </div>
            </div>
          </div>
        </section>

        <section class="page" id="pageOpt5">
          <div class="contentBox">
            <button class="backBtn backAny">ğŸ  Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
            <div class="promptCard">Ø§Ù„Ø®ÙŠØ§Ø± 5 (Ø¬Ø§Ù‡Ø² Ù„Ù„ØµÙ‚ Ù„Ø¹Ø¨ØªÙƒÙ… Ù‡Ù†Ø§)</div>
          </div>
        </section>

        <section class="page" id="pageOpt6">
          <div class="contentBox">
            <button class="backBtn backAny">ğŸ  Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
            <div class="promptCard">Ø§Ù„Ø®ÙŠØ§Ø± 6 (Ø¬Ø§Ù‡Ø² Ù„Ù„ØµÙ‚ Ù„Ø¹Ø¨ØªÙƒÙ… Ù‡Ù†Ø§)</div>
          </div>
        </section>

        <section class="page" id="pageOpt7">
          <div class="contentBox">
            <button class="backBtn backAny">ğŸ  Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
            <div class="promptCard">Ø§Ù„Ø®ÙŠØ§Ø± 7 (Ø¬Ø§Ù‡Ø² Ù„Ù„ØµÙ‚ Ù„Ø¹Ø¨ØªÙƒÙ… Ù‡Ù†Ø§)</div>
          </div>
        </section>

        <section class="page" id="pageOpt8">
          <div class="contentBox">
            <button class="backBtn backAny">ğŸ  Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
            <div class="promptCard">Ø§Ù„Ø®ÙŠØ§Ø± 8 (Ø¬Ø§Ù‡Ø² Ù„Ù„ØµÙ‚ Ù„Ø¹Ø¨ØªÙƒÙ… Ù‡Ù†Ø§)</div>
          </div>
        </section>

        <section class="page" id="pageOpt9">
          <div class="contentBox">
            <button class="backBtn backAny">ğŸ  Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
            <div class="promptCard">Ø§Ù„Ø®ÙŠØ§Ø± 9 (Ø¬Ø§Ù‡Ø² Ù„Ù„ØµÙ‚ Ù„Ø¹Ø¨ØªÙƒÙ… Ù‡Ù†Ø§)</div>
          </div>
        </section>

      </div>
    </div>
  </div>

  <!-- MENU MODAL (9 OPTIONS) -->
  <div class="modal" id="modal">
    <div class="modalCard">
      <div class="modalHead">
        <h3>ğŸ’— Ø§Ø®ØªÙØ± Ù…Ù† Ø¹Ø§Ù„Ù…Ù†Ø§ (Live)</h3>
        <button class="closeBtn" id="closeModal">âœ•</button>
      </div>
      <div class="grid">
        <button class="opt" data-go="pageGame">1) Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</button>
        <button class="opt" data-go="pageOpt2">2) <small>(Ø¬Ø§Ù‡Ø²)</small></button>
        <button class="opt" data-go="pageOpt3">3) Ø£Ù„ØºØ§Ø² Ø§Ù„Ø¨Ø­Ø± <small>(Live)</small></button>
        <button class="opt" data-go="pageOpt4">4) Ø¨Ø²Ù„ 200 <small>(Live)</small></button>
        <button class="opt" data-go="pageOpt5">5) <small>(Ø¬Ø§Ù‡Ø²)</small></button>
        <button class="opt" data-go="pageOpt6">6) <small>(Ø¬Ø§Ù‡Ø²)</small></button>
        <button class="opt" data-go="pageOpt7">7) <small>(Ø¬Ø§Ù‡Ø²)</small></button>
        <button class="opt" data-go="pageOpt8">8) <small>(Ø¬Ø§Ù‡Ø²)</small></button>
        <button class="opt" data-go="pageOpt9">9) <small>(Ø¬Ø§Ù‡Ø²)</small></button>
      </div>
    </div>
  </div>

  <!-- ğŸ”¥ Firebase (Module) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
    import { getFirestore, doc, setDoc, updateDoc, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBTr4NrjrEq3Lh23PIJ_Zz-KRr6yqgafyU",
      authDomain: "lanasnas-8de50.firebaseapp.com",
      projectId: "lanasnas-8de50",
      storageBucket: "lanasnas-8de50.firebasestorage.app",
      messagingSenderId: "847037285771",
      appId: "1:847037285771:web:096d4a14a984de41955b8e"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    window.fb = { auth, db, signInWithEmailAndPassword, onAuthStateChanged, signOut, doc, setDoc, updateDoc, onSnapshot, serverTimestamp };
  </script>

  <script>
    /********************
     * Hearts generator
     ********************/
    const heartsEl = document.getElementById("hearts");
    const HEARTS = ["â¤ï¸","ğŸ’—","ğŸ’","ğŸ’•","ğŸ’“","ğŸ’–","ğŸ’˜","ğŸ’","ğŸ’Ÿ","ğŸŒ¹"];
    function rand(min,max){ return Math.random()*(max-min)+min; }
    function spawnHearts(){
      heartsEl.innerHTML = "";
      const count = 26;
      for(let i=0;i<count;i++){
        const s = document.createElement("div");
        s.className = "heart";
        s.textContent = HEARTS[Math.floor(Math.random()*HEARTS.length)];
        const left = rand(2,98);
        const dur = rand(7,16);
        const delay = rand(0,10);
        const size = rand(16,28);
        s.style.left = left+"vw";
        s.style.animationDuration = dur+"s";
        s.style.animationDelay = (-delay)+"s";
        s.style.fontSize = size+"px";
        s.style.opacity = rand(.55,.95);
        heartsEl.appendChild(s);
      }
    }
    spawnHearts();
    setInterval(spawnHearts, 12000);

    /********************
     * Rain generator (Option 3 theme)
     ********************/
    const rainEl = document.getElementById("rain");
    function spawnRain(){
      if(!rainEl) return;
      rainEl.innerHTML = "";
      const count = 70;
      for(let i=0;i<count;i++){
        const d = document.createElement("div");
        d.className = "drop";
        d.style.left = rand(0,100) + "vw";
        d.style.animationDuration = rand(0.7, 1.6) + "s";
        d.style.animationDelay = (-rand(0,2.5)) + "s";
        d.style.height = rand(10, 22) + "px";
        d.style.opacity = rand(0.25, 0.8);
        rainEl.appendChild(d);
      }
    }
    spawnRain();
    setInterval(spawnRain, 9000);

    /********************
     * âœ… NEW: Emoji rain (ğŸŸâ¤ï¸â“) for Option 3
     ********************/
    const seaEmojisEl = document.getElementById("seaEmojis");
    const SEA_EMOJIS = ["ğŸŸ","â¤ï¸","â“","ğŸ’—","ğŸ ","ğŸ’•","â”","ğŸ’˜"];
    function spawnSeaEmojis(){
      if(!seaEmojisEl) return;
      seaEmojisEl.innerHTML = "";
      const count = 34;
      for(let i=0;i<count;i++){
        const e = document.createElement("div");
        e.className = "seaEmoji";
        e.textContent = SEA_EMOJIS[Math.floor(Math.random()*SEA_EMOJIS.length)];
        e.style.left = rand(2,98) + "vw";
        e.style.animationDuration = rand(5.5, 11) + "s";
        e.style.animationDelay = (-rand(0,7)) + "s";
        e.style.fontSize = rand(16, 30) + "px";
        e.style.opacity = rand(.45,.95);
        seaEmojisEl.appendChild(e);
      }
    }
    spawnSeaEmojis();
    setInterval(spawnSeaEmojis, 11000);

    /********************
     * âœ… NEW: Puzzle-piece rain (Option 4)
     ********************/
    const puzzleRainEl = document.getElementById("puzzleRain");
    function spawnPuzzleRain(){
      if(!puzzleRainEl) return;
      puzzleRainEl.innerHTML = "";
      const count = 40;
      for(let i=0;i<count;i++){
        const d = document.createElement("div");
        d.className = "puzDrop";
        d.style.left = rand(0,100) + "vw";
        d.style.animationDuration = rand(2.6, 6.2) + "s";
        d.style.animationDelay = (-rand(0,3.0)) + "s";
        const size = rand(12, 20);
        d.style.width = size + "px";
        d.style.height = size + "px";
        d.style.opacity = rand(0.30, 0.80);
        d.style.borderRadius = rand(5, 9) + "px";
        puzzleRainEl.appendChild(d);
      }
    }
    spawnPuzzleRain();
    setInterval(spawnPuzzleRain, 11000);

    /********************
     * Wait for Firebase
     ********************/
    function waitForFb(){
      return new Promise((resolve)=>{
        const t = setInterval(()=>{
          if(window.fb && window.fb.auth && window.fb.db){
            clearInterval(t);
            resolve(true);
          }
        }, 50);
      });
    }

    /********************
     * Pages
     ********************/
    const pages = Array.from(document.querySelectorAll(".page"));
    const topbar = document.getElementById("topbar");

    function showPageLocal(id){
      pages.forEach(p=>p.classList.remove("active"));
      const el = document.getElementById(id);
      if(el) el.classList.add("active");

      // Theme: Option 3 = sea + rain
      const isSea = (id === "pageOpt3");
      document.body.classList.toggle("seaTheme", isSea);
      if(isSea) spawnSeaEmojis();

      // Theme: Option 4 = puzzle theme
      const isPuz = (id === "pageOpt4");
      document.body.classList.toggle("puzzleTheme", isPuz);
      if(isPuz) spawnPuzzleRain();
    }

    /********************
     * Menu modal (UI only)
     ********************/
    const modal = document.getElementById("modal");
    const menuBtn = document.getElementById("menuBtn");
    const closeModal = document.getElementById("closeModal");

    function openModal(){ modal.classList.add("show"); }
    function closeModalFn(){ modal.classList.remove("show"); }

    menuBtn?.addEventListener("click", openModal);
    closeModal?.addEventListener("click", closeModalFn);
    modal?.addEventListener("click", (e)=>{ if(e.target===modal) closeModalFn(); });

    /********************
     * Packs (questions/challenges) â€” Ù„Ø¹Ø¨Ø© 1 (Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±)
     ********************/
    const lana1_questions = [
      "Ù…ØªÙ‰ Ø­Ø³Ù‘ÙŠØª Ø¥Ù†Ùƒ Ù…Ø±ØªØ§Ø­ Ù…Ø¹ÙŠ Ø¨Ø¯ÙˆÙ† Ù…Ø§ ØªÙ…Ø«Ù‘Ù„ØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ØªØ­Ø¨Ù‡ ÙÙŠÙ‘ ÙˆÙ…Ø§ ØªÙ‚ÙˆÙ„Ù‡ ÙƒØ«ÙŠØ±ØŸ",
      "Ù…ØªÙ‰ ØªØ­Ø³ Ø¥Ù†ÙŠ Ø£Ù‚Ø±Ø¨ Ù„Ùƒ: Ø¨Ø§Ù„ÙƒÙ„Ø§Ù… ÙˆÙ„Ø§ Ø¨Ø§Ù„Ø³ÙƒÙˆØªØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± ØªØµØ±Ù Ø¨Ø³ÙŠØ· Ù…Ù†ÙŠ ÙŠØ£Ø«Ø± ÙÙŠÙƒØŸ",
      "ÙˆØ´ Ø´Ø¹ÙˆØ±Ùƒ Ù„Ù…Ø§ Ø£Ø·ÙˆÙ‘Ù„ ÙˆÙ…Ø§ Ø£Ø±Ø¯ØŸ",
      "ÙƒÙŠÙ ØªØ­Ø¨ Ø£ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ùƒ ÙˆÙ‚Øª Ø²Ø¹Ù„ÙƒØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ØªØªØ±Ø¯Ø¯ ØªÙ‚ÙˆÙ„Ù‡ Ù„ÙŠØŸ",
      "Ù…ØªÙ‰ Ø­Ø³Ù‘ÙŠØª Ø¥Ù†ÙŠ ÙÙ‡Ù…ØªÙƒ ÙØ¹Ù„Ù‹Ø§ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠØ·Ù…Ù†Ùƒ Ø¨Ø¹Ù„Ø§Ù‚ØªÙ†Ø§ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠÙ‚Ù„Ù‚Ùƒ Ø¹Ù„ÙŠÙ†Ø§ØŸ",
      "Ù„Ùˆ Ù†Ø®ØªÙ„ÙØŒ ÙˆØ´ ØªØªÙ…Ù†Ù‰ Ù…Ø§ ÙŠØµÙŠØ± Ø¨ÙŠÙ†Ø§ØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ØªØ­Ø¨ Ø£Ø­Ø§ÙØ¸ Ø¹Ù„ÙŠÙ‡ Ø¯Ø§ÙŠÙ…Ù‹Ø§ØŸ",
      "Ù…ØªÙ‰ ØªØ­Ø³ Ø¥Ù†Ùƒ ØªØ­ØªØ§Ø¬Ù†ÙŠ Ø£ÙƒØ«Ø±ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ØªØ­Ø¨ Ù†Ø³ÙˆÙŠÙ‡ Ø³ÙˆØ§ØŸ",
      "ÙˆØ´ Ø´ÙŠ ØªØªÙ…Ù†Ù‰ Ø£Ù„Ø§Ø­Ø¸Ù‡ Ø¨Ø¯ÙˆÙ† Ù…Ø§ ØªØ·Ù„Ø¨ØŸ",
      "ÙƒÙŠÙ ØªØ­Ø¨ Ø£Ø¹Ø¨Ù‘Ø± Ù„Ùƒ Ø¹Ù† Ø­Ø¨ÙŠØŸ",
      "ÙˆØ´ Ù…ÙˆÙ‚Ù Ø®Ù„Ø§Ùƒ ØªØªØ¹Ù„Ù‘Ù‚ ÙÙŠÙ‘ Ø£ÙƒØ«Ø±ØŸ",
      "ÙˆØ´ Ø´Ø¹ÙˆØ±Ùƒ Ù„Ù…Ø§ Ø£ÙƒÙˆÙ† Ù…Ø´ØºÙˆÙ„ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± ÙƒÙ„Ù…Ø© ØªØ£Ø«Ø± ÙÙŠÙƒ Ù…Ù†ÙŠØŸ",
      "ÙˆØ´ Ø´ÙŠ Ø¨ÙŠÙ†Ø§ ØªØ­Ø¨ ÙŠÙƒÙˆÙ† Ø®Ø§ØµØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¨Ø§Ù„Ø£Ù…Ø§Ù† Ù…Ø¹ÙŠØŸ",
      "ÙˆØ´ ØªØ®Ø§Ù Ù†Ø®Ø³Ø±Ù‡ Ù„Ùˆ Ø£Ù‡Ù…Ù„Ù†Ø§Ù‡ØŸ",
      "ÙˆØ´ ÙˆØ¯Ùƒ Ù†Ø·ÙˆÙ‘Ø±Ù‡ ÙÙŠ ØªÙˆØ§ØµÙ„Ù†Ø§ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠÙˆØ¬Ø¹Ùƒ Ù„Ùˆ ØµØ§Ø± Ø¨ÙŠÙ†Ø§ØŸ",
      "Ù…ØªÙ‰ Ø­Ø³Ù‘ÙŠØª Ø¥Ù†Ùƒ ØªØ­Ø¨Ù†ÙŠØŸ",
      "ÙˆØ´ ØªØªÙ…Ù†Ù‰ Ø£Ø³ÙˆÙŠÙ‡ Ù„Ù…Ø§ ØªÙƒÙˆÙ† Ù…ØªØ¶Ø§ÙŠÙ‚ØŸ",
      "ÙˆØ´ ØªØµØ±Ù Ù…Ù†ÙŠ ÙŠÙØ±Ù‚ Ù…Ø¹Ùƒ Ø£ÙƒØ«Ø± Ù…Ù…Ø§ Ø£ØªÙˆÙ‚Ø¹ØŸ",
      "ÙˆØ´ Ø´ÙŠ ØªØ­Ø¨Ù†ÙŠ Ø£Ø³ØªÙ…Ø± Ø£Ø³ÙˆÙŠÙ‡ØŸ",
      "ÙˆØ´ Ø´ÙŠ ØªØ­Ø¨Ù†ÙŠ Ø£ÙˆÙ‚Ù‘Ù Ø£Ø³ÙˆÙŠÙ‡ØŸ",
      "ÙˆØ´ ØªØ­Ø³ Ø¥Ù†ÙŠ Ø£Ø¶ÙŠÙÙ‡ Ù„Ø­ÙŠØ§ØªÙƒØŸ",
      "Ù„Ùˆ ÙˆØµÙØª Ø¹Ù„Ø§Ù‚ØªÙ†Ø§ Ø¨ÙƒÙ„Ù…Ø©ØŒ ÙˆØ´ ØªÙƒÙˆÙ†ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠØ®Ù„ÙŠÙƒ ØªØ´ØªØ§Ù‚ Ù„ÙŠØŸ",
      "ÙˆØ´ Ù„Ø­Ø¸Ø© Ø¨ÙŠÙ†Ø§ Ù…Ø§ ØªÙ†Ø³Ø§Ù‡Ø§ØŸ",
      "ÙˆØ´ ØªØ­Ø¨ ÙÙŠ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù‡ØªÙ…Ø§Ù…ÙŠØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠØ·Ù…Ù†Ùƒ ÙÙŠ ÙˆØ¬ÙˆØ¯ÙŠØŸ",
      "ÙˆØ´ ÙˆØ¯Ùƒ Ø£Ø³Ù…Ø¹Ù‡ Ù…Ù†Ùƒ Ø£ÙƒØ«Ø±ØŸ",
      "ÙˆØ´ ØªØ­Ø³ Ø¥Ù†ÙŠ Ø£ÙÙ‡Ù…Ù‡ Ø¹Ù†ÙƒØŸ",
      "ÙˆØ´ ØªØ­Ø³ Ø¥Ù†ÙŠ Ù…Ø§ Ø£ÙÙ‡Ù…Ù‡ Ø¹Ù†ÙƒØŸ",
      "ÙˆØ´ ÙˆØ¹Ø¯ ØªØ­Ø¨ Ù†Ù„ØªØ²Ù… ÙÙŠÙ‡ Ø³ÙˆØ§ØŸ",
      "ÙˆØ´ Ø´Ø¹ÙˆØ±Ùƒ Ù„Ù…Ø§ ØªØªØ®ÙŠÙ„ Ù…Ø³ØªÙ‚Ø¨Ù„Ù†Ø§ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ØªØ­Ø¨Ù‡ ÙÙŠ Ù‚Ø±Ø¨Ù†Ø§ØŸ",
      "ÙˆØ´ Ø´ÙŠ ØªØªÙ…Ù†Ù‰ Ù†Ø¹ÙŠØ´Ù‡ Ø³ÙˆØ§ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¥Ù†Ùƒ Ù…Ù‡Ù… Ø¹Ù†Ø¯ÙŠØŸ",
      "ÙˆØ´ ØªØ­Ø¨ ØªØ³Ù…Ø¹Ù‡ Ù…Ù†ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ù†ÙˆÙ…ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¨Ø§Ù„Ø­Ø¨ØŸ"
    ];

    const lana1_challenges = [
      "Ù‚ÙˆÙ„ Ø¨ØµÙˆØªÙƒ: Ø´Ø¹ÙˆØ±Ùƒ Ø§Ù„Ø¢Ù† Ø¨ØµØ¯Ù‚.",
      "Ù‚ÙˆÙ„: 3 Ø£Ø´ÙŠØ§Ø¡ ØªØ­Ø³Ù‡Ø§ Ø¨ÙŠÙ†Ø§ ÙˆÙ…Ø§ ØªØ­Ø¨ ØªØ¶ÙŠØ¹.",
      "Ù‚ÙˆÙ„: Ø¬Ù…Ù„Ø© ØªØ­Ø¨ ØªØ³Ù…Ø¹Ù‡Ø§ Ù…Ù†ÙŠ.",
      "Ù‚ÙˆÙ„ Ø¨ØµÙˆØªÙƒ: Ù„Ø­Ø¸Ø© Ø­Ø³Ù‘ÙŠØª ÙÙŠÙ‡Ø§ Ø¥Ù†Ùƒ Ù‚Ø±ÙŠØ¨ Ù…Ù†ÙŠ.",
      "Ù‚ÙˆÙ„: Ø´ÙŠ ÙŠØ·Ù…Ù†Ùƒ Ø¨Ø¹Ù„Ø§Ù‚ØªÙ†Ø§.",
      "ØµÙˆÙ‘Ø±: Ø´ÙŠØ¡ Ø­ÙˆÙ„Ùƒ ØªØ­Ø³Ù‘Ù‡ ÙŠØ¹Ø¨Ù‘Ø± Ø¹Ù† Ù‡Ø¯ÙˆØ¡.",
      "Ù‚ÙˆÙ„: Ø´ÙŠ ÙˆØ¯Ùƒ Ø£Ø³ØªÙ…Ø± Ø£Ø³ÙˆÙŠÙ‡.",
      "Ù‚ÙˆÙ„ Ø¨ØµÙˆØªÙƒ: ÙƒÙŠÙ ØªØ­Ø¨ Ø£ÙˆØ§Ø³ÙŠÙƒ.",
      "ØµÙˆÙ‘Ø±: Ø´ÙŠØ¡ ØªØ­Ø¨Ù‡ ÙÙŠ Ù…ÙƒØ§Ù†Ùƒ Ø§Ù„Ø¢Ù†.",
      "Ù‚ÙˆÙ„: Ø´ÙŠ ØªØ®Ø§Ù Ù†Ø®Ø³Ø±Ù‡ Ø¨ÙŠÙ†Ø§.",
      "Ù‚ÙˆÙ„ Ø¨ØµÙˆØªÙƒ: Ù„ÙŠÙ‡ ÙˆØ¬ÙˆØ¯ÙŠ Ù…Ù‡Ù… Ù„Ùƒ.",
      "ØµÙˆÙ‘Ø±: Ù„ÙˆÙ† ØªØ­Ø³Ù‘Ù‡ ÙŠÙ…Ø«Ù‘Ù„ Ø´Ø¹ÙˆØ±Ùƒ Ø§Ù„Ø¢Ù†.",
      "Ù‚ÙˆÙ„: Ø´ÙŠ ØªØ­Ø¨ Ù†Ø³ÙˆÙŠÙ‡ Ø³ÙˆØ§ ÙƒØ«ÙŠØ±.",
      "ØµÙˆÙ‘Ø±: Ø´ÙŠØ¡ Ø¨Ø³ÙŠØ· ÙŠÙØ±Ù‘Ø­Ùƒ.",
      "Ù‚ÙˆÙ„ Ø¨ØµÙˆØªÙƒ: Ø£Ø¬Ù…Ù„ Ù„Ø­Ø¸Ø© Ø­Ø³Ù‘ÙŠØª ÙÙŠÙ‡Ø§ Ø¨Ø§Ù„Ø­Ø¨.",
      "Ù‚ÙˆÙ„: Ø´ÙŠ ÙˆØ¯Ùƒ Ø£Ù‚ÙˆÙ„Ù‡ Ù„Ùƒ Ø£ÙƒØ«Ø±.",
      "ØµÙˆÙ‘Ø±: Ø´ÙŠØ¡ ÙŠØ°ÙƒÙ‘Ø±Ùƒ Ø¨Ø§Ù„Ø±Ø§Ø­Ø©.",
      "Ù‚ÙˆÙ„ Ø¨ØµÙˆØªÙƒ: Ø´ÙŠ ØªØ­Ø¨Ù†ÙŠ Ø£Ù‚Ø¯Ù‘Ø±Ù‡ ÙÙŠÙƒ.",
      "ØµÙˆÙ‘Ø±: Ø´ÙŠØ¡ ØªØ­Ø³Ù‘Ù‡ Ø¯Ø§ÙÙŠ.",
      "Ù‚ÙˆÙ„: Ø´ÙŠ ÙŠØ±ÙŠØ­Ùƒ Ù„Ù…Ø§ ØªØ³Ù…Ø¹Ù‡.",
      "Ù‚ÙˆÙ„ Ø¨ØµÙˆØªÙƒ: ÙˆØ´ ØªØ­Ø³ Ù„Ù…Ø§ Ø£ÙƒÙˆÙ† Ø¬Ù†Ø¨Ùƒ.",
      "ØµÙˆÙ‘Ø±: Ø´ÙŠØ¡ ØªØ­Ø¨ ÙˆØ¬ÙˆØ¯Ù‡ Ø¨Ø­ÙŠØ§ØªÙƒ.",
      "Ù‚ÙˆÙ„: Ø´ÙŠ ØªØ­Ø¨Ù†ÙŠ Ø£Ù„Ø§Ø­Ø¸Ù‡.",
      "ØµÙˆÙ‘Ø±: Ù„Ù‚Ø·Ø© ØªØ¹Ø¬Ø¨Ùƒ Ø§Ù„Ø¢Ù†.",
      "Ù‚ÙˆÙ„ Ø¨ØµÙˆØªÙƒ: ÙƒÙ„Ù…Ø© ØªØ­Ø³Ù‡Ø§ Ø¨ÙŠÙ†Ø§.",
      "Ù‚ÙˆÙ„: Ø´ÙŠ ØªØªÙ…Ù†Ù‰ Ù†Ø¹ÙŠØ´Ù‡ Ø³ÙˆØ§.",
      "ØµÙˆÙ‘Ø±: Ø´ÙŠØ¡ ÙŠØ®Ù„ÙŠÙƒ ØªØ¨ØªØ³Ù….",
      "Ù‚ÙˆÙ„ Ø¨ØµÙˆØªÙƒ: ÙƒÙŠÙ ØªØ´ÙˆÙÙ†Ø§.",
      "ØµÙˆÙ‘Ø±: Ø´ÙŠØ¡ ÙŠØ¹ÙƒØ³ Ù…Ø²Ø§Ø¬Ùƒ.",
      "Ù‚ÙˆÙ„: Ø´ÙŠ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¨Ø§Ù„Ø­Ø¨.",
      "Ù‚ÙˆÙ„ Ø¨ØµÙˆØªÙƒ: ÙˆØ¹Ø¯ Ø¨Ø³ÙŠØ·.",
      "ØµÙˆÙ‘Ø±: Ø´ÙŠØ¡ ÙˆØ¯Ùƒ ØªØ´Ø§Ø±ÙƒÙ†ÙŠ Ø¥ÙŠØ§Ù‡.",
      "Ù‚ÙˆÙ„: Ø´ÙŠ ØªØ­Ø¨ ØªØ³Ù…Ø¹Ù‡ Ù…Ù†ÙŠ.",
      "ØµÙˆÙ‘Ø±: Ø´ÙŠØ¡ ØªØ­Ø³Ù‘Ù‡ Ø®Ø§Øµ.",
      "Ù‚ÙˆÙ„ Ø¨ØµÙˆØªÙƒ: Ø¬Ù…Ù„Ø© Ù…Ù† Ù‚Ù„Ø¨Ùƒ.",
      "Ù‚ÙˆÙ„: Ø´ÙŠ ØªØ­Ø¨Ù†ÙŠ Ø£Ø­Ø§ÙØ¸ Ø¹Ù„ÙŠÙ‡.",
      "ØµÙˆÙ‘Ø±: Ø´ÙŠØ¡ ØªØ­Ø¨ Ø´ÙƒÙ„Ù‡.",
      "Ù‚ÙˆÙ„ Ø¨ØµÙˆØªÙƒ: (Ø£Ù†Ø§ Ù…Ø¹Ùƒ Ù„Ø£Ù†â€¦).",
      "ØµÙˆÙ‘Ø±: Ø´ÙŠØ¡ ÙŠØ¹Ø¨Ù‘Ø± Ø¹Ù†Ùƒ Ø§Ù„ÙŠÙˆÙ….",
      "Ù‚ÙˆÙ„: Ø´ÙŠ ÙŠØ·Ù…Ù†Ùƒ ÙÙŠÙ‘."
    ];

    const lana2_questions = [
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠØ·Ù…Ù†Ùƒ ÙÙŠ ÙˆØ¬ÙˆØ¯ÙŠØŸ",
      "Ù…ØªÙ‰ ØªØ­Ø³ Ø¥Ù†Ùƒ Ø¹Ù„Ù‰ Ø·Ø¨ÙŠØ¹ØªÙƒ Ù…Ø¹ÙŠØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ØªØ­Ø¨ Ù†Ø«Ø¨Ù‘ØªÙ‡ Ø¨ÙŠÙ†Ø§ ÙˆÙ…Ø§ ÙŠØªØºÙŠÙ‘Ø±ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ØªØ­ØªØ§Ø¬Ù‡ Ù…Ù†ÙŠ Ù‡Ø§Ù„ÙØªØ±Ø©ØŸ",
      "ÙƒÙŠÙ ØªØ­Ø¨ Ø£ÙƒÙˆÙ† Ø¬Ù†Ø¨Ùƒ ÙˆÙ‚Øª Ø§Ù„Ø¶ØºØ·ØŸ",
      "ÙˆØ´ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¥Ù†Ùƒ Ù…Ùˆ Ù„Ø­Ø§Ù„ÙƒØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± ØªØµØ±Ù‘Ù Ù…Ù†ÙŠ ÙŠØ¹Ø·ÙŠÙƒ Ø£Ù…Ø§Ù†ØŸ",
      "Ù…ØªÙ‰ ØªØ­Ø³ Ø¥Ù†Ù†Ø§ ÙØ±ÙŠÙ‚ ÙˆØ§Ø­Ø¯ØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ØªØ­Ø¨ Ø£Ø³ØªÙ…Ø± Ø£Ø³ÙˆÙŠÙ‡ Ù…Ù‡Ù…Ø§ ØµØ§Ø±ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠØ®Ù„ÙŠÙƒ ØªØ«Ù‚ØŸ",
      "ÙƒÙŠÙ ØªØ­Ø¨ Ù†Ø­Ù„ Ø®Ù„Ø§ÙØ§ØªÙ†Ø§ØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ÙŠÙˆØ¬Ø¹Ùƒ Ù„Ùˆ Ø­Ø³Ù‘ÙŠØª Ø¥Ù†ÙŠ ØªØ¬Ø§Ù‡Ù„ØªÙ‡ØŸ",
      "ÙˆØ´ Ø£Ø³ÙˆØ£ Ø´Ø¹ÙˆØ± ØªØ­Ø¨ Ù†ØªØ¬Ù†Ø¨Ù‡ Ø¨ÙŠÙ†Ø§ØŸ",
      "ÙˆØ´ Ø§Ù„ØªØµØ±Ù‘Ù Ø§Ù„Ù„ÙŠ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¥Ù†ÙŠ Ù…ÙˆØ¬ÙˆØ¯ ÙØ¹Ù„Ù‹Ø§ØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ØªØ­Ø¨Ù†ÙŠ Ø£Ù†ØªØ¨Ù‡ Ù„Ù‡ Ø£ÙƒØ«Ø±ØŸ",
      "ÙˆØ´ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¨Ø§Ù„Ø§Ø³ØªÙ‚Ø±Ø§Ø±ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ØªØ®Ø§Ù ÙŠØ£Ø«Ø± Ø¹Ù„ÙŠÙ†Ø§ Ù„Ùˆ Ù…Ø§ Ø§Ù†ØªØ¨Ù‡Ù†Ø§ Ù„Ù‡ØŸ",
      "ÙƒÙŠÙ ØªØ­Ø¨ Ø£Ø±Ø¬Ù‘Ø¹Ùƒ Ù„Ù†Ù‚Ø·Ø© Ø§Ù„Ø£Ù…Ø§Ù† Ù„Ùˆ ØªÙˆØªØ±ØªØŸ",
      "ÙˆØ´ Ø£Ø³Ù„ÙˆØ¨Ùƒ ÙˆÙ‚Øª Ø§Ù„Ø²Ø¹Ù„ ÙˆØªØ­Ø¨Ù†ÙŠ Ø£ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡ ÙƒÙŠÙØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠØ±ÙŠØ­Ùƒ Ø¨Ø§Ù„ÙƒÙ„Ø§Ù…ØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ØªØ­Ø¨ ÙŠÙƒÙˆÙ† ÙˆØ§Ø¶Ø­ Ø¨ÙŠÙ†Ø§ Ø¯Ø§ÙŠÙ…Ù‹Ø§ØŸ",
      "ÙˆØ´ ØªØ­Ø³ Ø¥Ù†Ù†Ø§ Ø³ÙˆÙŠÙ†Ø§Ù‡ ØµØ­ØŸ",
      "ÙˆØ´ ÙˆØ¯Ùƒ Ù†Ø·ÙˆÙ‘Ø±Ù‡ Ø¨Ø¯ÙˆÙ† Ø¶ØºØ·ØŸ",
      "ÙˆØ´ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¥Ù†Ùƒ Ù…Ø³Ù…ÙˆØ¹ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ØªØ­Ø¨ Ù†Ø´Ø§Ø±ÙƒÙ‡ Ù…Ø¹ Ø¨Ø¹Ø¶ØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¥Ù†ÙŠ Ù…Ø¹Ùƒ Ø­ØªÙ‰ ÙˆØ£Ù†Ø§ Ø¨Ø¹ÙŠØ¯ØŸ",
      "ÙˆØ´ Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„ØµØºÙŠØ±Ø© Ø§Ù„Ù„ÙŠ ØªÙØ±Ù‚ Ù…Ø¹Ùƒ ÙƒØ«ÙŠØ±ØŸ",
      "ÙˆØ´ ÙŠØ®Ù„ÙŠÙƒ ØªØ·Ù…Ø¦Ù† Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø¨ÙŠÙ†Ø§ØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ÙˆØ¯Ùƒ Ù†ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡ Ø¨ÙˆØ¶ÙˆØ­ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ØªØ­Ø¨ ÙÙŠ Ø·Ø±ÙŠÙ‚Ø© ØªÙˆØ§ØµÙ„Ù†Ø§ØŸ",
      "ÙˆØ´ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¨Ø§Ù„Ø±Ø§Ø­Ø© ÙˆÙ‚Øª Ø§Ù„ØµÙ…ØªØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ÙˆØ¯Ùƒ Ø£Ø­Ù…ÙŠÙ‡ Ù„ÙƒØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠØ«Ø¨ØªÙƒ ÙˆÙ‚Øª Ø§Ù„Ù‚Ù„Ù‚ØŸ",
      "ÙˆØ´ ØªØ­Ø¨ ÙŠÙƒÙˆÙ† Ø±Ø¯Ù‘ÙŠ Ù„Ùˆ ÙƒÙ†Øª Ù…Ø­ØªØ§Ø¬ØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¥Ù†Ùƒ Ù…Ù‡Ù…ØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ØªØ­Ø¨ Ù†Ø±Ø§Ø¬Ø¹Ù‡ Ø¨ÙŠÙ† ÙØªØ±Ø© ÙˆÙØªØ±Ø©ØŸ",
      "ÙˆØ´ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¥Ù†Ù†Ø§ Ø«Ø§Ø¨ØªÙŠÙ†ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙˆØ¯Ùƒ Ø£ÙƒÙˆÙ†Ù‡ Ù„ÙƒØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ØªØ­Ø¨ Ù†ÙƒÙ…Ù‘Ù„Ù‡ Ø³ÙˆØ§ØŸ",
      "ÙˆØ´ Ø´Ø¹ÙˆØ±Ùƒ Ù„Ù…Ø§ ØªØ­Ø³ Ø¥Ù†Ù†Ø§ Ù…ØªÙØ§Ù‡Ù…ÙŠÙ†ØŸ",
      "ÙˆØ´ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¨Ø§Ù„Ø·Ù…Ø£Ù†ÙŠÙ†Ø© Ø§Ù„Ø¢Ù†ØŸ",
      "ÙˆØ´ Ø§Ù„Ø´ÙŠ Ø§Ù„Ù„ÙŠ ØªØ­Ø¨ Ø£Ø°ÙƒÙ‘Ø±Ùƒ ÙÙŠÙ‡ Ø¯Ø§ÙŠÙ…Ù‹Ø§ØŸ",
      "ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠ ÙŠØ®ÙÙ Ø¹Ù†ÙƒØŸ",
      "ÙˆØ´ ØªØ­Ø¨ Ù†ÙƒÙˆÙ† Ø¹Ù„ÙŠÙ‡ Ø¨Ø¹Ø¯ ÙØªØ±Ø©ØŸ",
      "ÙˆØ´ Ø¥Ø­Ø³Ø§Ø³Ùƒ ØªØ¬Ø§Ù‡Ù†Ø§ Ø§Ù„ÙŠÙˆÙ…ØŸ"
    ];

    const lana2_challenges = [
      "Ø§Ø±Ø³Ù„ ÙÙˆÙŠØ³ Ù‚ØµÙŠØ± ØªØ·Ù…Ù‘Ù† ÙÙŠÙ‡ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ.",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ Ù‚Ø¯Ø§Ù…Ùƒ ØªØ­Ø³Ù‘Ù‡ ÙŠØ¹Ø¨Ù‘Ø± Ø¹Ù† Ø§Ù„Ø£Ù…Ø§Ù†.",
      "Ø§Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© ØªÙ‚ÙˆÙ„ ÙÙŠÙ‡Ø§ Ø´ÙŠ ÙˆØ§Ø­Ø¯ ÙŠØ±ÙŠØ­Ùƒ.",
      "ØµÙˆÙ‘Ø± Ù…ÙƒØ§Ù†Ùƒ Ø§Ù„Ø¢Ù† Ù„Ùˆ ÙƒØ§Ù† Ù‡Ø§Ø¯Ø¦.",
      "Ø§Ø±Ø³Ù„ ÙƒÙ„Ù…Ø© ØªØ·Ù…Ù‘Ù† Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ.",
      "ÙÙˆÙŠØ³: Ø§Ø­ÙƒÙŠ Ø¹Ù† Ø´ÙŠØ¡ Ø±ÙŠÙ‘Ø­Ùƒ Ø§Ù„ÙŠÙˆÙ….",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ ØªØ­Ø¨ ÙˆØ¬ÙˆØ¯Ù‡ Ø­ÙˆÙ„Ùƒ.",
      "Ø§Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ø´ÙƒØ± Ù‚ØµÙŠØ±Ø©.",
      "ØµÙˆÙ‘Ø± Ù„ÙˆÙ† ØªØ­Ø³Ù‘Ù‡ ÙŠÙ…Ø«Ù‘Ù„ Ù…Ø²Ø§Ø¬Ùƒ.",
      "ÙÙˆÙŠØ³: Ø§Ø­ÙƒÙŠ Ø¹Ù† Ø´Ø¹ÙˆØ±Ùƒ Ø§Ù„Ø¢Ù†.",
      "Ø§Ø±Ø³Ù„ Ø¬Ù…Ù„Ø© ØªØ­Ø¨ ØªØ³Ù…Ø¹Ù‡Ø§ Ù…Ù† Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ.",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ Ø«Ø§Ø¨Øª ÙÙŠ ÙŠÙˆÙ…Ùƒ.",
      "ÙÙˆÙŠØ³: Ù‚ÙˆÙ„ Ø´ÙŠ ÙŠØ®Ù„ÙŠÙƒ ØªØ­Ø³ Ø¨Ø§Ù„Ø£Ù…Ø§Ù†.",
      "ØµÙˆÙ‘Ø± Ù„Ù‚Ø·Ø© Ø¯Ø§ÙØ¦Ø© (Ø¶ÙˆØ¡ØŒ Ù‚Ù‡ÙˆØ©ØŒ Ù…ÙƒØ§Ù†).",
      "Ø§Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ø¯Ø¹Ù… Ø¨Ø³ÙŠØ·Ø©.",
      "ÙÙˆÙŠØ³: Ø§Ø­ÙƒÙŠ Ù…ØªÙ‰ ØªØ­Ø³ Ø¥Ù†ÙƒÙ… ÙØ±ÙŠÙ‚.",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ ÙŠØ¹Ø¨Ù‘Ø± Ø¹Ù† Ø§Ù„Ù‡Ø¯ÙˆØ¡.",
      "Ø§Ø±Ø³Ù„ Ø¬Ù…Ù„Ø© ØªØ·Ù…Ù‘Ù† Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ.",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ ØªØ­Ø¨ Ø´ÙƒÙ„Ù‡.",
      "ÙÙˆÙŠØ³: Ø§Ø­ÙƒÙŠ Ø´ÙŠ ÙŠØ®ÙÙ ØªÙˆØªØ±Ùƒ.",
      "Ø§Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© ØªÙ‚ÙˆÙ„ ÙÙŠÙ‡Ø§ Ø¥Ù†Ùƒ Ù…ÙˆØ¬ÙˆØ¯.",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ ÙŠØ¹Ø¨Ù‘Ø± Ø¹Ù† Ø§Ù„Ù‚Ø±Ø¨.",
      "ÙÙˆÙŠØ³: Ø§Ø­ÙƒÙŠ Ø¹Ù† Ø´ÙŠ ØªØ­Ø¨ Ù†Ø­Ø§ÙØ¸ Ø¹Ù„ÙŠÙ‡.",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ Ø¨Ø³ÙŠØ· ÙŠÙØ±Ø­Ùƒ.",
      "Ø§Ø±Ø³Ù„ ÙƒÙ„Ù…Ø© ØªÙ‚Ø¯ÙŠØ±.",
      "ÙÙˆÙŠØ³: Ù‚ÙˆÙ„ ÙˆØ¹Ø¯ ØµØºÙŠØ±.",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ ØªØ­Ø¨ ÙˆØ¬ÙˆØ¯Ù‡ Ø¨Ø­ÙŠØ§ØªÙƒ.",
      "Ø§Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ù‚ØµÙŠØ±Ø© Ø¨Ø¯ÙˆÙ† Ø³Ø¨Ø¨.",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ ØªØ­Ø³Ù‘Ù‡ Ø¢Ù…Ù†.",
      "ÙÙˆÙŠØ³: Ø§Ø­ÙƒÙŠ Ø¹Ù† Ø´ÙŠ ØªØ­Ø¨ Ù†ÙƒÙ…Ù‘Ù„Ù‡ Ø³ÙˆØ§.",
      "Ø§Ø±Ø³Ù„ Ø¬Ù…Ù„Ø© ØªØ±ÙŠØ­ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ.",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ ÙŠØ¹ÙƒØ³ Ø´Ø¹ÙˆØ±Ùƒ Ø§Ù„Ø¢Ù†.",
      "ÙÙˆÙŠØ³: Ø§Ø­ÙƒÙŠ Ø¹Ù† Ø´ÙŠ Ø®Ù„Ø§Ùƒ ØªØ·Ù…Ø¦Ù†.",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ ØªØ­Ø¨Ù‡ Ø§Ù„ÙŠÙˆÙ….",
      "Ø§Ø±Ø³Ù„ ÙƒÙ„Ù…Ø© ØªØ­Ø³Ù‡Ø§ Ø¨ÙŠÙ†ÙƒÙ….",
      "ÙÙˆÙŠØ³: Ø§Ø­ÙƒÙŠ Ø¹Ù† Ø´ÙŠ ÙŠØ®Ù„ÙŠÙƒ ØªØ«Ù‚.",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ ÙŠØ¹Ø¨Ù‘Ø± Ø¹Ù† Ø§Ù„Ø«Ø¨Ø§Øª.",
      "Ø§Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© ØªÙ‚ÙˆÙ„ ÙÙŠÙ‡Ø§ (Ø£Ù†Ø§ Ù…Ø¹Ùƒ).",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ Ø¨Ø³ÙŠØ· ØªØ­Ø¨Ù‡.",
      "ÙÙˆÙŠØ³: Ø§Ø­ÙƒÙŠ Ø¥Ø­Ø³Ø§Ø³Ùƒ ØªØ¬Ø§Ù‡ÙƒÙ…."
    ];

    const lana3_questions = [
      "Ø£Ø­Ø³ Ø¥Ù† Ø£ÙƒØ«Ø± ÙˆÙ‚Øª Ù†ÙƒÙˆÙ† ÙÙŠÙ‡ Ø¹Ù„Ù‰ Ø·Ø¨ÙŠØ¹ØªÙ†Ø§ Ù‡Ùˆ Ù„Ù…Ø§ Ù…Ø§ Ù†Ø®Ø·Ø·.",
      "ÙÙŠÙ‡ Ø£Ø´ÙŠØ§Ø¡ Ø¨Ø³ÙŠØ·Ø© Ø¨ÙŠÙ†Ø§ ØµØ§Ø±Øª Ø·Ø¨ÙŠØ¹ÙŠØ© Ù…Ø±Ø©.",
      "Ø£Ø­ÙŠØ§Ù†Ù‹Ø§ Ø§Ù„ØµÙ…Øª Ø¨ÙŠÙ†Ù†Ø§ Ù…Ø±ÙŠØ­ Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„ÙƒÙ„Ø§Ù….",
      "ÙÙŠÙ‡ ØªØµØ±ÙØ§Øª Ù†Ø³ÙˆÙŠÙ‡Ø§ ÙˆÙ…Ø§ Ù†Ù†ØªØ¨Ù‡ Ù„Ù‡Ø§ Ù„ÙƒÙ†Ù‡Ø§ ØªØ¶Ø­Ùƒ.",
      "Ø£Ø±ØªØ§Ø­ Ù„Ù…Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ø¬Ùˆ Ø®ÙÙŠÙ Ø¨Ø¯ÙˆÙ† ØªÙˆÙ‚Ø¹Ø§Øª.",
      "Ø£Ø­Ø¨ ÙÙƒØ±Ø© Ø¥Ù†Ù†Ø§ Ù†Ù‚Ø¯Ø± Ù†ÙƒÙˆÙ† Ø¹ÙÙˆÙŠÙŠÙ†.",
      "ÙÙŠÙ‡ Ø£Ø´ÙŠØ§Ø¡ Ø¨ÙŠÙ†Ø§ Ù…Ø§ ØªØ­ØªØ§Ø¬ ØªÙØ³ÙŠØ±.",
      "Ø§Ù„Ø±Ø§Ø­Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù„Ù…Ø§ Ù…Ø§ Ø£ÙÙƒØ± ÙˆØ´ Ø£Ù‚ÙˆÙ„.",
      "Ø£Ø¶Ø­Ùƒ Ù„Ù…Ø§ Ø£ÙØªÙƒØ± Ù…ÙˆØ§Ù‚Ù Ø¨Ø³ÙŠØ·Ø© ØµØ§Ø±Øª Ø¨ÙŠÙ†Ø§.",
      "ÙÙŠÙ‡ Ø£ÙˆÙ‚Ø§Øª Ø£Ø­Ø³ Ø¥Ù†Ù†Ø§ Ù†ÙÙ‡Ù… Ø¨Ø¹Ø¶ Ø¨Ø¯ÙˆÙ† ÙƒÙ„Ø§Ù….",
      "Ø§Ù„Ø¹ÙÙˆÙŠØ© Ø¨ÙŠÙ† Ø´Ø®ØµÙŠÙ† Ù†Ø¹Ù…Ø©.",
      "ÙÙŠÙ‡ Ø¹Ø§Ø¯Ø§Øª ØµØºÙŠØ±Ø© ØªØµÙ†Ø¹ Ø§Ù„Ø±Ø§Ø­Ø©.",
      "Ø£Ø­Ø¨ Ù„Ù…Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ø²Ø§Ø¬ Ø¨Ø³ÙŠØ·.",
      "Ø£Ø­ÙŠØ§Ù†Ù‹Ø§ Ø§Ù„Ø³Ø®Ø§ÙØ© ØªÙ‚Ø±Ù‘Ø¨ Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„Ø¬Ø¯ÙŠØ©.",
      "Ø§Ù„Ø±Ø§Ø­Ø© ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØµØºÙŠØ±Ø©.",
      "Ø£Ø­Ø³ Ø¥Ù† Ø§Ù„Ø¶Ø­Ùƒ Ø¨Ø¯ÙˆÙ† Ø³Ø¨Ø¨ Ø¹Ù„Ø§Ù…Ø© Ø£Ù…Ø§Ù†.",
      "ÙÙŠÙ‡ Ø£Ø´ÙŠØ§Ø¡ Ù†Ø³ÙˆÙŠÙ‡Ø§ ÙˆØªÙƒÙˆÙ† Ø¹Ø§Ø¯ÙŠØ© Ù„Ù†Ø§ ÙˆØºØ±ÙŠØ¨Ø© Ù„ØºÙŠØ±Ù†Ø§.",
      "Ø§Ù„Ø·Ø¨ÙŠØ¹Ø© ØªØ·Ù„Ø¹ Ù„Ù…Ø§ Ù†ÙƒÙˆÙ† Ù…Ø±ØªØ§Ø­ÙŠÙ†.",
      "Ø£Ø­Ø¨ Ø§Ù„Ù„Ø­Ø¸Ø§Øª Ø§Ù„Ù„ÙŠ Ù…Ø§ ØªÙƒÙˆÙ† Ù…Ø«Ø§Ù„ÙŠØ©.",
      "Ø§Ù„Ø¨Ø³Ø§Ø·Ø© ØªØ®Ù„ÙŠ Ø§Ù„Ø¬Ùˆ Ø¯Ø§ÙÙŠ.",
      "Ø£Ø±ØªØ§Ø­ Ù„Ù…Ø§ Ù†ÙƒÙˆÙ† Ø¹Ù„Ù‰ Ø³Ø¬ÙŠØªÙ†Ø§.",
      "ÙÙŠÙ‡ Ø£Ø´ÙŠØ§Ø¡ Ø¨ÙŠÙ†Ø§ Ù…Ø§ ØªØ­ØªØ§Ø¬ ØªØ±ØªÙŠØ¨.",
      "Ø£Ø­Ø¨ Ø§Ù„Ù…Ø²Ø§Ø¬ Ø§Ù„Ù„ÙŠ ÙŠØ¬ÙŠ Ø¨Ø¯ÙˆÙ† Ù…Ù‚Ø¯Ù…Ø§Øª.",
      "Ø§Ù„Ø¶Ø­Ùƒ ÙŠØ®ÙÙ Ø£ÙŠ ØªÙˆØªØ±.",
      "Ø§Ù„Ø¹ÙÙˆÙŠØ© ØªØ­Ø±Ø±.",
      "ÙÙŠÙ‡ Ù„Ø­Ø¸Ø§Øª ØªÙƒÙˆÙ† Ø®ÙÙŠÙØ© Ø¨Ø³ Ø¹Ù…ÙŠÙ‚Ø©.",
      "Ø£Ø­Ø¨ Ù„Ù…Ø§ Ù†ÙƒÙˆÙ† ØµØ§Ø¯Ù‚ÙŠÙ† Ø¨Ø¯ÙˆÙ† ØªÙÙƒÙŠØ±.",
      "Ø£Ø­Ø³ Ø¥Ù† Ø§Ù„Ø±Ø§Ø­Ø© ØªØ²ÙŠØ¯ Ù„Ù…Ø§ Ù†Ø¶Ø­Ùƒ Ø¹Ù„Ù‰ Ù†ÙØ³Ù†Ø§.",
      "ÙÙŠÙ‡ Ù…ÙˆØ§Ù‚Ù Ø¨Ø³ÙŠØ·Ø© ØªØ¨Ù‚Ù‰ ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©.",
      "Ø£Ø­Ø¨ Ù„Ù…Ø§ Ù…Ø§ Ù†Ø­ØªØ§Ø¬ Ù†Ø«Ø¨Øª Ø´ÙŠ.",
      "Ø§Ù„Ø±Ø§Ø­Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© ØªÙƒÙˆÙ† Ø¨Ø¯ÙˆÙ† Ù…Ø¬Ù‡ÙˆØ¯.",
      "Ø£Ø­Ø¨ Ù„Ù…Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ø¬Ùˆ Ø·Ø¨ÙŠØ¹ÙŠ.",
      "ÙÙŠÙ‡ Ø£Ø´ÙŠØ§Ø¡ Ø¨ÙŠÙ†Ø§ ØµØ§Ø±Øª Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„ÙŠÙˆÙ….",
      "Ø§Ù„Ø¶Ø­Ùƒ Ø§Ù„Ù…Ø´ØªØ±Ùƒ ÙŠÙ‚Ø±Ø¨.",
      "Ø§Ù„Ø¹ÙÙˆÙŠØ© ØªØ®Ù„ÙŠ Ø§Ù„ÙˆÙ‚Øª ÙŠÙ…Ø´ÙŠ Ø£Ø³Ø±Ø¹.",
      "Ø£Ø±ØªØ§Ø­ Ù„Ù…Ø§ Ù…Ø§ Ù†ÙƒÙˆÙ† Ø±Ø³Ù…ÙŠÙŠÙ†.",
      "ÙÙŠÙ‡ Ø£ÙˆÙ‚Ø§Øª Ø£Ø­Ø³ Ø¥Ù†Ù†Ø§ Ù…ØªÙØ§Ù‡Ù…ÙŠÙ† Ø¨Ø¯ÙˆÙ† Ø´Ø±Ø­.",
      "Ø§Ù„Ø¨Ø³Ø§Ø·Ø© ØªØ²ÙŠØ¯ Ø§Ù„Ù‚Ø±Ø¨.",
      "Ø£Ø­Ø¨ Ø§Ù„Ø¬Ùˆ Ø§Ù„Ù„ÙŠ Ù…Ø§ ÙÙŠÙ‡ Ø£Ø­ÙƒØ§Ù….",
      "Ø§Ù„Ø±Ø§Ø­Ø© Ø¥Ø­Ø³Ø§Ø³ØŒ Ù…Ùˆ ØªØµØ±Ù."
    ];

    const lana3_challenges = [
      "Ø§Ù†Ø¨Ø­ Ø®Ù…Ø³ Ù…Ø±Ø§Øª ÙˆØ§Ù„Ù‡Ø«.",
      "Ù‚Ù„Ù‘Ø¯ ØµÙˆØª Ø¨Ù‚Ø±Ø©.",
      "Ù‚Ù„Ù‘Ø¯ ØµÙˆØª Ø«Ø¹Ø¨Ø§Ù†.",
      "Ù‚Ù„Ù‘Ø¯ ØµÙˆØª Ø¹Ø¬ÙˆØ².",
      "Ù‚Ù„Ù‘Ø¯ ØµÙˆØª Ù…Ø¹Ø²Ø©.",
      "Ù‚Ù„Ù‘Ø¯ ØµÙˆØª Ø·ÙÙ„ (Ù†ÙˆÙ†Ùˆ).",
      "Ù‚Ù„Ù‘Ø¯ ØµÙˆØª Ø³Ø¨ÙˆÙ†Ø¬ Ø¨ÙˆØ¨.",
      "Ù‚Ù„Ù‘Ø¯ ØµÙˆØª Ø£Ø³Ø¯.",
      "Ù‚Ù„Ù‘Ø¯ ØµÙˆØª Ø«ÙˆØ±.",
      "Ù‚Ù„Ù‘Ø¯ ØµÙˆØª Ø®Ù†Ø²ÙŠØ±.",
      "Ø³ÙˆÙ‘ Ø£ÙƒØ«Ø± Ø­Ø±ÙƒØ© Ù…Ù‚Ø²Ø²Ø© (ØªÙ…Ø«ÙŠÙ„ ÙÙ‚Ø·) ØªÙƒØ³Ø± Ø§Ù„Ø¬Ø¯ÙŠØ©.",
      "Ø§Ø±Ù‚Øµ Ø±Ù‚ØµØ© ØºØ¨ÙŠØ© Ù„Ù…Ø¯Ø© 10 Ø«ÙˆØ§Ù†ÙŠ.",
      "ØµÙˆÙ‘Ø± Ù„Ø³Ø§Ù†Ùƒ.",
      "ØµÙˆÙ‘Ø± ÙˆØ¬Ù‡Ùƒ Ø¨Ø£ØºØ±Ø¨ ØªØ¹Ø¨ÙŠØ±.",
      "ØµÙˆÙ‘Ø± Ù„Ù‚Ø·Ø© ÙˆØ§Ù†Øª ØªØ³ÙˆÙŠ Ø­Ø±ÙƒØ© ØºØ¨ÙŠØ©.",
      "Ù…Ø«Ù‘Ù„ Ø­Ø±ÙƒØ© Ù…Ù‚Ø²Ø²Ø© Ø¨Ø¯ÙˆÙ† Ù„Ù…Ø³.",
      "Ù‚Ù„ Ø¬Ù…Ù„Ø© ÙˆØ§Ù†Øª ØªØºÙŠÙ‘Ø± ØµÙˆØªÙƒ 3 Ù…Ø±Ø§Øª.",
      "Ù…Ø«Ù‘Ù„ Ø£Ù†Ùƒ Ù…Ø³ØªØ¹Ø¬Ù„ Ø¬Ø¯Ù‹Ø§ Ø¨Ø¯ÙˆÙ† ÙƒÙ„Ø§Ù…."
    ];

    const lana4_questions = ["ØªØ­Ø¨Ù†ÙŠ."];
    const lana4_challenges = ["ØªØ­Ø¨Ù†ÙŠ."];

    const PACKS = {
      lana1: { questions: lana1_questions, challenges: lana1_challenges },
      lana2: { questions: lana2_questions, challenges: lana2_challenges },
      lana3: { questions: lana3_questions, challenges: lana3_challenges },
      lana4: { questions: lana4_questions, challenges: lana4_challenges }
    };

    function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    /********************
     * Auth mapping (username -> email)
     ********************/
    const USER_MAP = {
      anas: "anas@love.local",
      lana: "lana@love.local"
    };

    const loginUser = document.getElementById("loginUser");
    const loginPass = document.getElementById("loginPass");
    const loginBtn  = document.getElementById("loginBtn");
    const loginMsg  = document.getElementById("loginMsg");

    const whoPill = document.getElementById("whoPill");
    const modeSelect = document.getElementById("modeSelect");
    const promptCard = document.getElementById("promptCard");
    const syncLine = document.getElementById("syncLine");

    const ROOM_ID = "our-world";
    const roomRef = ()=> window.fb.doc(window.fb.db, "rooms", ROOM_ID);

    let currentName = null;
    let CURRENT_MODE = "lana1";

    function setMsg(text, type=""){
      loginMsg.className = "msg " + (type||"");
      loginMsg.textContent = text || "";
    }

    function normalizeToEmail(v){
      const raw = (v||"").trim().toLowerCase();
      if(!raw) return "";
      if(raw.includes("@")) return raw;
      if(USER_MAP[raw]) return USER_MAP[raw];
      return raw;
    }

    /********************
     * Ensure Room
     ********************/
    async function ensureRoom(){
      try{
        await window.fb.setDoc(roomRef(), {
          roomId: ROOM_ID,
          currentPage: "pageHome",
          currentMode: CURRENT_MODE,
          promptText: "Ø§Ø¨Ø¯Ø£ âœ¨ Ø§Ø®ØªØ± (Ø³Ø¤Ø§Ù„ / ØªØ­Ø¯ÙŠ)",
          promptType: "init",
          lastBy: "system",
          updatedAt: window.fb.serverTimestamp(),

          opt2: {
            q: "",
            anas: "",
            lana: "",
            readyAnas: false,
            readyLana: false,
            updatedBy: "system"
          },

          opt3: {
            stage: 1,
            selected: -1,
            solved: false,
            lastText: "Ø§Ø®ØªØ§Ø±ÙˆØ§ Ø¬ÙˆØ§Ø¨ Ù…Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ğŸ‘† (Live)",
            loveText: "",
            showLove: false,
            punishText: "",
            confirmAnas: false,
            confirmLana: false,

            /* âœ… NEW CONTROL FIELDS */
            evaluatedStage: 0,
            autoNext: false,
            autoNextDone: false,
            updatedBy: "system"
          },

          /* âœ… NEW: OPTION 4 puzzle state */
          opt4puz: {
            stage: 1,
            grid: 3,
            img: "",
            shuffle: [],
            placed: {},
            sel: -1,
            solved: false,
            roles: { viewer: "ANAS", assembler: "LANA" },
            updatedBy: "system"
          }
        }, { merge:true });
      }catch(e){}
    }

    async function doLogin(){
      const email = normalizeToEmail(loginUser.value);
      const pass = (loginPass.value||"").trim();
      if(!email || !pass){
        setMsg("Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±", "bad");
        return;
      }
      setMsg("â€¦ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„");
      try{
        const cred = await window.fb.signInWithEmailAndPassword(window.fb.auth, email, pass);
        const em = (cred.user.email||"").toLowerCase();
        currentName = em.startsWith("lana") ? "LANA" : "ANAS";
        setMsg("ØªÙ… âœ…", "ok");
      }catch(err){
        setMsg("Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­", "bad");
      }
    }

    loginBtn.addEventListener("click", doLogin);
    loginPass.addEventListener("keydown", (e)=>{ if(e.key==="Enter") doLogin(); });
    loginUser.addEventListener("keydown", (e)=>{ if(e.key==="Enter") doLogin(); });

    /********************
     * Live sync
     ********************/
    let unsubRoom = null;

    async function pushRoomUpdate(payload){
      try{
        await window.fb.updateDoc(roomRef(),{
          ...payload,
          lastBy: currentName || "unknown",
          updatedAt: window.fb.serverTimestamp()
        });
      }catch(e){}
    }

    function pushPage(pageId){
      pushRoomUpdate({ currentPage: pageId });
    }

    async function pushPrompt(type){
      const pack = PACKS[CURRENT_MODE] || PACKS.lana1;
      const list = (type==="q") ? pack.questions : pack.challenges;
      const icon = (type==="q") ? "ğŸ’—" : "ğŸ”¥";
      const text = `${icon} ${pick(list)}`;
      await pushRoomUpdate({
        currentMode: CURRENT_MODE,
        promptText: text,
        promptType: type
      });
    }

    /********************
     * Option 2
     ********************/
    const amkQuestion = document.getElementById("amkQuestion");
    const amkMe = document.getElementById("amkMe");
    const amkOther = document.getElementById("amkOther");
    const amkSave = document.getElementById("amkSave");
    const amkNew = document.getElementById("amkNew");
    const amkStatus = document.getElementById("amkStatus");
    const amkMeAs = document.getElementById("amkMeAs");
    const amkOtherAs = document.getElementById("amkOtherAs");
    const amkHintMe = document.getElementById("amkHintMe");
    const amkHintOther = document.getElementById("amkHintOther");

    const AMK_QUESTIONS = [
      "Ù„Ùˆ ÙƒÙ†Øª Ù…ÙƒØ§Ù†ÙŠ Ø§Ù„Ø¢Ù†â€¦ ÙˆØ´ Ø£ÙƒØ«Ø± Ø´ÙŠØ¡ ØªØ­ØªØ§Ø¬Ù‡ Ù…Ù†ÙŠ Ø§Ù„ÙŠÙˆÙ…ØŸ",
      "Ø£Ù†Ø§ Ù…ÙƒØ§Ù†Ùƒâ€¦ ÙˆØ´ Ø§Ù„Ø´ÙŠØ¡ Ø§Ù„Ù„ÙŠ ÙŠØ·Ù…Ù†Ùƒ ÙÙˆØ±Ù‹Ø§ØŸ",
      "Ø£Ù†Ø§ Ù…ÙƒØ§Ù†Ùƒâ€¦ ÙˆØ´ Ø§Ù„Ø´ÙŠØ¡ Ø§Ù„Ù„ÙŠ ÙŠÙˆØ¬Ø¹Ùƒ ÙˆÙ…Ø§ ØªÙ‚ÙˆÙ„Ù‡ØŸ",
      "Ø£Ù†Ø§ Ù…ÙƒØ§Ù†Ùƒâ€¦ ÙˆØ´ ØªØªÙˆÙ‚Ø¹ Ø¥Ù†ÙŠ Ø£ÙÙƒØ± ÙÙŠÙ‡ Ø§Ù„Ø­ÙŠÙ†ØŸ",
      "Ø£Ù†Ø§ Ù…ÙƒØ§Ù†Ùƒâ€¦ ÙˆØ´ Ø£Ù…Ù†ÙŠØ© Ø¨Ø³ÙŠØ·Ø© ØªØ¨ØºØ§Ù†ÙŠ Ø£Ø­Ù‚Ù‚Ù‡Ø§ Ù„ÙƒØŸ"
    ];
    function pickAmkQ(){
      return AMK_QUESTIONS[Math.floor(Math.random()*AMK_QUESTIONS.length)];
    }

    function myKey(){ return (currentName === "ANAS") ? "anas" : "lana"; }
    function otherKey(){ return (currentName === "ANAS") ? "lana" : "anas"; }
    function myReadyKey(){ return (currentName === "ANAS") ? "readyAnas" : "readyLana"; }
    function otherReadyKey(){ return (currentName === "ANAS") ? "readyLana" : "readyAnas"; }

    function safeSetTextareaValue(el, nextValue){
      if(!el) return;
      if(document.activeElement === el) return;
      const v = (typeof nextValue === "string") ? nextValue : "";
      if(el.value !== v) el.value = v;
    }

    amkSave?.addEventListener("click", async ()=>{
      const txt = (amkMe?.value || "").trim();
      if(!txt){
        if(amkStatus) amkStatus.textContent = "Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ø£ÙˆÙ„Ø§Ù‹ âœï¸";
        return;
      }
      if(amkStatus) amkStatus.textContent = "â€¦ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸";

      if(currentName === "ANAS"){
        await pushRoomUpdate({
          "opt2.anas": txt,
          "opt2.readyAnas": true,
          "opt2.updatedBy": currentName || "unknown"
        });
      }else{
        await pushRoomUpdate({
          "opt2.lana": txt,
          "opt2.readyLana": true,
          "opt2.updatedBy": currentName || "unknown"
        });
      }

      if(amkStatus) amkStatus.textContent = "ØªÙ… Ø­ÙØ¸ Ø¥Ø¬Ø§Ø¨ØªÙƒ âœ…";
    });

    amkNew?.addEventListener("click", async ()=>{
      await pushRoomUpdate({
        "opt2.q": pickAmkQ(),
        "opt2.anas": "",
        "opt2.lana": "",
        "opt2.readyAnas": false,
        "opt2.readyLana": false,
        "opt2.updatedBy": currentName || "unknown"
      });
      if(amkStatus) amkStatus.textContent = "Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯ ğŸŒ¹";
    });

    /********************
     * OPTION 3: Ø§Ø­Ù†Ø§ Ø£Ù‚ÙˆÙ‰ Ù…Ù† Ø§Ù„Ø³Ù…ÙƒØ© (DATA)
     ********************/
    const FISH_PUNISH = [
      "ØµÙˆÙ‘Ø± 3 Ø«ÙˆØ§Ù†ÙŠ ÙˆØ£Ù†Øª ØªØ³ÙˆÙŠ Ø£ØºØ±Ø¨ ØªØ¹Ø¨ÙŠØ± ÙˆØ¬Ù‡ ğŸ˜µâ€ğŸ’«",
      "ÙÙˆÙŠØ³ 5 Ø«ÙˆØ§Ù†ÙŠ ØªÙ‚ÙˆÙ„: (Ø£Ù†Ø§ Ø£Ø­Ø¨Ùƒ) Ø¨ØµÙˆØª ØªÙ…Ø«ÙŠÙ„ÙŠ ğŸ¤­",
      "ØµÙˆÙ‘Ø± ÙŠØ¯Ùƒ ØªØ³ÙˆÙŠ Ù‚Ù„Ø¨ Ø¨Ø³Ø±Ø¹Ø© â¤ï¸",
      "ØµÙˆÙ‘Ø± Ø´ÙŠØ¡ Ù‚Ø±ÙŠØ¨ Ù…Ù†Ùƒ ÙˆÙ‚Ù„: (Ù‡Ø°Ø§ ÙŠØ°ÙƒØ±Ù†ÙŠ ÙÙŠÙƒ) ğŸ¥¹",
      "ÙÙˆÙŠØ³: Ù‚Ù„ ÙƒÙ„Ù…Ø© (Ø¨Ø®Ø®Ø®) ÙƒØ£Ù†Ùƒ Ø·ÙÙ„ ğŸ˜­",
      "ØµÙˆÙ‘Ø± Ù†ÙØ³Ùƒ ØªØ³ÙˆÙŠ Ø³Ù„Ø§Ù… Ø¹Ø³ÙƒØ±ÙŠ 2 Ø«Ø§Ù†ÙŠØ© ğŸ«¡",
      "ÙÙˆÙŠØ³: Ù‚Ù„Ø¯ ØµÙˆØª Ø±ÙˆØ¨ÙˆØª 5 Ø«ÙˆØ§Ù†ÙŠ ğŸ¤–",
      "ØµÙˆÙ‘Ø± Ø¶Ø­ÙƒØªÙƒ Ø¨Ø¯ÙˆÙ† Ø³Ø¨Ø¨ 3 Ø«ÙˆØ§Ù†ÙŠ ğŸ˜„",
      "ØµÙˆÙ‘Ø± Ø­Ø±ÙƒØ© Ø±Ù‚Øµ ØºØ¨ÙŠØ© 2 Ø«Ø§Ù†ÙŠØ© ğŸ’ƒ",
      "ØµÙˆÙ‘Ø± Ø£Ù‚Ø±Ø¨ Ø´ÙŠ Ù„ÙˆÙ†Ù‡ Ø£Ø­Ù…Ø± ğŸ”´"
    ];

    const FISH_LOVE = [
      "Ø£Ù†Ø³ ÙˆÙ„Ø§Ù†Ø§â€¦ ÙƒÙ„ Ù…Ø±Ø­Ù„Ø© Ù†Ø¹Ø¯Ù‘ÙŠÙ‡Ø§ Ø³ÙˆØ§ ØªØ«Ø¨Øª Ø¥Ù†Ù†Ø§ ÙØ±ÙŠÙ‚ ÙˆØ§Ø­Ø¯ â¤ï¸",
      "Ø§Ù„Ù‚Ø±Ø¨ Ù…Ùˆ Ù…ÙƒØ§Ù†â€¦ Ø§Ù„Ù‚Ø±Ø¨ Ø§Ø®ØªÙŠØ§Ø± ğŸ’—",
      "Ù…Ø§ ÙŠÙ‡Ù… ØµØ¹ÙˆØ¨Ø© Ø§Ù„Ù„ØºØ²â€¦ Ø§Ù„Ù…Ù‡Ù… Ø¥Ù†Ù†Ø§ Ù†Ø­Ù„Ù‘Ù‡ Ø³ÙˆØ§ ğŸ«¶",
      "ÙƒÙ„ 4 Ù…Ø±Ø§Ø­Ù„ = Ø°ÙƒØ±Ù‰ ØµØºÙŠØ±Ø© ØªØªØ±Ø³Ø® Ø¨ÙŠÙ†ÙƒÙ… ğŸŒ¹",
      "Ø£Ù†ØªÙ… Ø£Ù‚ÙˆÙ‰ Ù…Ù† Ø£ÙŠ Ø¸Ø±Ùâ€¦ Ù„Ø£Ù†ÙƒÙ… Ù…Ø¹ Ø¨Ø¹Ø¶ ğŸ¤",
      "Ù‡Ø°Ø§ Ø¹Ø§Ù„Ù…ÙƒÙ…â€¦ ÙˆØ§Ù„Ù„ÙŠ Ø¨ÙŠÙ†ÙƒÙ… Ø£ØºÙ„Ù‰ Ù…Ù† Ø£ÙŠ Ù„ØºØ² ğŸ’—",
      "Ù‚Ù„Ø¨ÙŠÙ†â€¦ Ø¨Ø³ Ù†ÙØ³ Ø§Ù„Ù†Ø¨Ø¶ â¤ï¸",
      "Ø­ØªÙ‰ Ø§Ù„ØºÙ„Ø·â€¦ ÙŠØµÙŠØ± Ù„Ø·ÙŠÙ Ø¥Ø°Ø§ Ø£Ù†ØªÙ… Ø³ÙˆØ§ ğŸ¤­",
      "ÙƒÙ„ Ù…Ø±Ø­Ù„Ø©â€¦ Ø®Ø·ÙˆØ© Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ø£Ø¬Ù…Ù„ ğŸ¤",
      "Ø£Ù‚ÙˆÙ‰ Ø´ÙŠØŸ Ø¥Ù†ÙƒÙ… Ù…Ø§ ØªØªØ±ÙƒÙˆÙ† Ø¨Ø¹Ø¶ ğŸ’"
    ];

    const FISH_LEVELS = [
      ["Ø´ÙŠØ¡ ÙƒÙ„Ù…Ø§ Ø£Ø®Ø°Øª Ù…Ù†Ù‡ ÙƒØ¨Ø±ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø§Ù„Ø­ÙØ±Ø©","Ø§Ù„Ø´Ù…Ø¹Ø©","Ø§Ù„ÙˆÙ‚Øª","Ø§Ù„Ø¸Ù„"], 0],
      ["Ø´ÙŠØ¡ Ù„Ø§ ÙŠÙÙƒØ³Ø± Ø¥Ù„Ø§ Ø¥Ø°Ø§ Ù†Ø·Ù‚Øª Ø§Ø³Ù…Ù‡ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø§Ù„ØµÙ…Øª","Ø§Ù„Ø²Ø¬Ø§Ø¬","Ø§Ù„Ø³Ø±","Ø§Ù„Ù‡ÙˆØ§Ø¡"], 0],
      ["Ø¨ÙŠØª Ø¨Ù„Ø§ Ø£Ø¨ÙˆØ§Ø¨ ÙˆÙ„Ø§ Ù†ÙˆØ§ÙØ°ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["ØµÙ†Ø¯ÙˆÙ‚","Ø¨ÙŠØ¶Ø©","Ù‚Ù„Ø¨","ÙƒÙ‡Ù"], 1],
      ["Ù„Ù‡ Ø£Ø³Ù†Ø§Ù† ÙˆÙ„Ø§ ÙŠØ¹Ø¶ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø§Ù„Ù…Ø´Ø·","Ø§Ù„ÙƒÙ„Ø¨","Ø§Ù„Ù…Ù†Ø´Ø§Ø±","Ø§Ù„Ø°Ø¦Ø¨"], 0],
      ["ÙŠØ±Ø§Ùƒ ÙˆÙ„Ø§ ØªØ±Ø§Ù‡ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø§Ù„Ù…Ø±Ø¢Ø©","Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§","Ø§Ù„Ø¸Ù„","Ø§Ù„Ù‡ÙˆØ§Ø¡"], 1],

      ["Ù…Ø§ Ø§Ù„Ø´ÙŠØ¡ Ø§Ù„Ø°ÙŠ ÙŠÙ…Ø´ÙŠ Ø¨Ù„Ø§ Ø±Ø¬Ù„ÙŠÙ†ØŸ", ["Ø§Ù„Ø¸Ù„","Ø§Ù„Ù…Ø·Ø±","Ø§Ù„Ù†Ù‡Ø±","Ø§Ù„ÙˆÙ‚Øª"], 2],
      ["Ù…Ø§ Ø§Ù„Ø´ÙŠØ¡ Ø§Ù„Ø°ÙŠ Ø¥Ø°Ø§ Ø²Ø§Ø¯ Ù†Ù‚ØµØŸ", ["Ø§Ù„Ø¹Ù…Ø±","Ø§Ù„Ù…Ø§Ù„","Ø§Ù„Ø¶ÙˆØ¡","Ø§Ù„Ù…Ø§Ø¡"], 0],
      ["ÙƒÙ… Ø´Ù‡Ø± ÙÙŠ Ø§Ù„Ø³Ù†Ø© ÙÙŠÙ‡ 28 ÙŠÙˆÙ…ØŸ", ["1","2","12","ÙŠØ¹ØªÙ…Ø¯"], 2],
      ["Ø´ÙŠØ¡ ÙŠÙƒØªØ¨ ÙˆÙ„Ø§ ÙŠÙ‚Ø±Ø£ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø§Ù„Ù‚Ù„Ù…","Ø§Ù„ÙƒØªØ§Ø¨","Ø§Ù„Ø­Ø¨Ø±","Ø§Ù„Ù…Ø³Ø·Ø±Ø©"], 0],
      ["Ù„Ù‡ ÙˆØ¬Ù‡ ÙˆÙŠØ¯Ø§Ù† ÙˆÙ„ÙŠØ³ Ø¥Ù†Ø³Ø§Ù†Ù‹Ø§ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø³Ø§Ø¹Ø©","ÙƒØ±Ø³ÙŠ","Ù…ÙŠØ²Ø§Ù†","Ø¨Ø§Ø¨"], 0],

      ["Ø´ÙŠØ¡ Ø¥Ø°Ø§ ÙØªØ­ØªÙ‡ Ù„Ø§ ÙŠØºÙ„Ù‚ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø§Ù„Ø¨Ø§Ø¨","Ø§Ù„ÙƒØªØ§Ø¨","Ø§Ù„ÙÙ…","Ø§Ù„Ù†Ø§ÙØ°Ø©"], 2],
      ["Ø´ÙŠØ¡ ÙŠÙˆÙ„Ø¯ ÙƒØ¨ÙŠØ±Ù‹Ø§ ÙˆÙŠÙ…ÙˆØª ØµØºÙŠØ±Ù‹Ø§ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø§Ù„Ø´Ù…Ø¹Ø©","Ø§Ù„Ù‚Ù…Ø±","Ø§Ù„Ø¸Ù„","Ø§Ù„Ø·ÙÙ„"], 0],
      ["Ù…Ø§ Ø§Ù„Ø´ÙŠØ¡ Ø§Ù„Ø°ÙŠ ÙŠØ³Ù…Ø¹ Ø¨Ù„Ø§ Ø£Ø°Ù† ÙˆÙŠØªÙƒÙ„Ù… Ø¨Ù„Ø§ Ù„Ø³Ø§Ù†ØŸ", ["Ø§Ù„ØµØ¯Ù‰","Ø§Ù„Ù‡Ø§ØªÙ","Ø§Ù„Ø±Ø§Ø¯ÙŠÙˆ","Ø§Ù„Ø±Ø³Ø§Ù„Ø©"], 0],
      ["Ø´ÙŠØ¡ ÙŠÙ…Ù„Ùƒ Ù…ÙØ§ØªÙŠØ­ ÙˆÙ„Ø§ ÙŠÙØªØ­ Ø£Ø¨ÙˆØ§Ø¨Ù‹Ø§ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø§Ù„Ø¨ÙŠØ§Ù†Ùˆ","Ø§Ù„Ù‚ÙÙ„","Ø§Ù„Ø³ÙŠØ§Ø±Ø©","Ø§Ù„Ù…ÙØªØ§Ø­"], 0],
      ["Ø´ÙŠØ¡ Ù…ØµÙ†ÙˆØ¹ Ù…Ù† Ù…Ø§Ø¡ ÙˆØ¥Ø°Ø§ ÙˆØ¶Ø¹ØªÙ‡ ÙÙŠ Ø§Ù„Ù…Ø§Ø¡ Ù…Ø§ØªØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø§Ù„Ø«Ù„Ø¬","Ø§Ù„Ù…Ù„Ø­","Ø§Ù„Ø²Ø¨Ø¯","Ø§Ù„Ø¨Ø®Ø§Ø±"], 0],

      ["Ù…Ø§ Ø§Ù„Ø´ÙŠØ¡ Ø§Ù„Ø°ÙŠ ÙŠØ²Ø¯Ø§Ø¯ ÙƒÙ„Ù…Ø§ Ø´Ø§Ø±ÙƒØªÙ‡ØŸ", ["Ø§Ù„Ù…Ø§Ù„","Ø§Ù„Ø¹Ù„Ù…","Ø§Ù„Ù†Ø§Ø±","Ø§Ù„Ø­Ø²Ù†"], 1],
      ["Ø´ÙŠØ¡ ÙŠÙ‚ÙŠØ³ ÙˆÙ„Ø§ ÙŠÙÙˆØ²Ù†ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø§Ù„Ø³Ø§Ø¹Ø©","Ø§Ù„Ø­Ø±Ø§Ø±Ø©","Ø§Ù„Ø·ÙˆÙ„","Ø§Ù„Ù…Ù„Ø­"], 0],
      ["Ø´ÙŠØ¡ Ù„Ù‡ Ø±Ù‚Ø¨Ø© Ø¨Ù„Ø§ Ø±Ø£Ø³ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø²Ø¬Ø§Ø¬Ø©","Ù‚Ù…ÙŠØµ","Ø·Ø§ÙˆÙ„Ø©","Ø²Ø±Ø§ÙØ©"], 0],
      ["Ù…Ø§ Ø§Ù„Ø´ÙŠØ¡ Ø§Ù„Ø°ÙŠ Ø¥Ø°Ø§ Ù„Ù…Ø³ØªÙ‡ ØµØ§Ø­ØŸ", ["Ø¬Ø±Ø³","Ø­Ø¯ÙŠØ¯","Ø¨Ø§Ø¨","Ø¸Ù„"], 0],
      ["Ø´ÙŠØ¡ ÙŠØ®ØªÙÙŠ Ø¥Ø°Ø§ Ù‚Ù„Øª Ø§Ø³Ù…Ù‡ØŒ Ù…Ø§ Ù‡ÙˆØŸ", ["Ø§Ù„ØµÙ…Øª","Ø§Ù„Ø¸Ù„","Ø§Ù„Ù†ÙˆØ±","Ø§Ù„Ù‡ÙˆØ§Ø¡"], 0]
    ];

    while(FISH_LEVELS.length < 150){
      const n = FISH_LEVELS.length + 1;
      FISH_LEVELS.push([
        `Ù„ØºØ² ${n}: Ø´ÙŠØ¡ ÙŠÙØ±Ù‰ ÙˆÙ„Ø§ ÙŠÙÙ„Ù…Ø³ØŒ Ù…Ø§ Ù‡ÙˆØŸ`,
        ["Ø§Ù„Ù‡ÙˆØ§Ø¡","Ø§Ù„Ø¸Ù„","Ø§Ù„ØµÙˆØª","Ø§Ù„ÙˆÙ‚Øª"],
        1
      ]);
    }
    if(FISH_LEVELS.length > 150) FISH_LEVELS.length = 150;

    function fishStageToIdx(stage){
      const s = Math.max(1, Math.min(150, parseInt(stage||1,10)));
      return s - 1;
    }
    function fishGetLevel(stage){
      return FISH_LEVELS[fishStageToIdx(stage)];
    }
    function fishLoveTextForStage(stage){
      if(stage % 4 !== 0) return "";
      const idx = Math.floor(stage/4) - 1;
      return FISH_LOVE[idx % FISH_LOVE.length];
    }
    function fishPickPunish(){
      return FISH_PUNISH[Math.floor(Math.random()*FISH_PUNISH.length)];
    }

    /********************
     * Option 3: DOM
     ********************/
    const fishStageBadge = document.getElementById("fishStageBadge");
    const fishQ = document.getElementById("fishQ");
    const fishC0 = document.getElementById("fishC0");
    const fishC1 = document.getElementById("fishC1");
    const fishC2 = document.getElementById("fishC2");
    const fishC3 = document.getElementById("fishC3");
    const fishResult = document.getElementById("fishResult");
    const fishLove = document.getElementById("fishLove");
    const fishPunishBtn = document.getElementById("fishPunishBtn");
    const fishConfirmBtn = document.getElementById("fishConfirmBtn");
    const fishNextBtn = document.getElementById("fishNextBtn");
    const fishStatus = document.getElementById("fishStatus");
    const fishConfirmLine = document.getElementById("fishConfirmLine");

    function setChoicesEnabled(enabled){
      [fishC0,fishC1,fishC2,fishC3].forEach(btn=>{
        if(!btn) return;
        btn.classList.toggle("disabled", !enabled);
      });
    }

    function applyFishUI(opt3){
      const stage = Math.max(1, Math.min(150, parseInt(opt3?.stage||1,10)));
      const lvl = fishGetLevel(stage);
      const q = lvl?.[0] || "â€¦";
      const choices = lvl?.[1] || ["â€¦","â€¦","â€¦","â€¦"];

      if(fishStageBadge) fishStageBadge.textContent = `Ø§Ù„Ù…Ø±Ø­Ù„Ø©: ${stage} / 150`;
      if(fishQ) fishQ.textContent = `â“ ${q}`;

      if(fishC0) fishC0.textContent = choices[0] ?? "â€”";
      if(fishC1) fishC1.textContent = choices[1] ?? "â€”";
      if(fishC2) fishC2.textContent = choices[2] ?? "â€”";
      if(fishC3) fishC3.textContent = choices[3] ?? "â€”";

      if(fishResult) fishResult.textContent = (opt3?.lastText ?? "Ø§Ø®ØªØ§Ø±ÙˆØ§ Ø¬ÙˆØ§Ø¨ Ù…Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ğŸ‘† (Live)");

      const loveText = opt3?.loveText || "";
      const showLove = !!opt3?.showLove && !!loveText;
      if(fishLove){
        fishLove.textContent = loveText || "";
        fishLove.classList.toggle("show", showLove);
      }

      const cA = !!opt3?.confirmAnas;
      const cL = !!opt3?.confirmLana;
      if(fishConfirmLine){
        fishConfirmLine.textContent =
          `ØªØ£ÙƒÙŠØ¯ Ø£Ù†Ø³: ${cA ? "âœ…" : "â€”"} | ØªØ£ÙƒÙŠØ¯ Ù„Ø§Ù†Ø§: ${cL ? "âœ…" : "â€”"} | (Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù…Ø§ ØªØ·Ù„Ø¹ Ø¥Ù„Ø§ Ø¥Ø°Ø§ Ø§Ù„Ø§Ø«Ù†ÙŠÙ† âœ…âœ…)`;
      }

      const locked = !!opt3?.autoNext && !opt3?.autoNextDone;
      setChoicesEnabled(!locked);

      if(fishNextBtn) fishNextBtn.disabled = true;
    }

    /********************
     * âœ… NEW: Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø¯ÙˆÙ† Ù†ØªÙŠØ¬Ø©
     ********************/
    async function fishChoose(choiceIndex){
      const stageSnap = window.__fishStageCache || 1;

      await pushRoomUpdate({
        "opt3.selected": choiceIndex,
        "opt3.solved": false,
        "opt3.lastText": "âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø®ÙŠØ§Ø±.\nØ§Ù„Ø¢Ù† Ø§Ø¶ØºØ·ÙˆØ§ (ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¬ÙˆØ§Ø¨) Ø£Ù†ØªÙ… Ø§Ù„Ø§Ø«Ù†ÙŠÙ† Ø¹Ø´Ø§Ù† ØªØ·Ù„Ø¹ Ø§Ù„Ù†ØªÙŠØ¬Ø©.",
        "opt3.loveText": "",
        "opt3.showLove": false,

        "opt3.confirmAnas": false,
        "opt3.confirmLana": false,
        "opt3.evaluatedStage": 0,
        "opt3.autoNext": false,
        "opt3.autoNextDone": false,
        "opt3.updatedBy": currentName || "unknown"
      });
    }

    fishC0?.addEventListener("click", ()=> fishChoose(0));
    fishC1?.addEventListener("click", ()=> fishChoose(1));
    fishC2?.addEventListener("click", ()=> fishChoose(2));
    fishC3?.addEventListener("click", ()=> fishChoose(3));

    fishPunishBtn?.addEventListener("click", async ()=>{
      const p = fishPickPunish();
      await pushRoomUpdate({
        "opt3.punishText": `âš ï¸ Ø¹Ù‚Ø§Ø¨: ${p}`,
        "opt3.lastText": `âš ï¸ Ø¹Ù‚Ø§Ø¨ Ø·Ù„Ø¹ Ù„ÙƒÙ…:\n${p}`,
        "opt3.updatedBy": currentName || "unknown"
      });
    });

    /********************
     * âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¬ÙˆØ§Ø¨ (Ø¨Ø¯ÙˆÙ† Ù†ØªÙŠØ¬Ø© Ù…Ø¨Ø§Ø´Ø±Ø©)
     ********************/
    fishConfirmBtn?.addEventListener("click", async ()=>{
      const sel = parseInt(window.__fishSelectedCache ?? -1, 10);
      if(sel < 0){
        await pushRoomUpdate({
          "opt3.lastText": "Ø§Ø®ØªØ§Ø±ÙˆØ§ Ø®ÙŠØ§Ø± Ø£ÙˆÙ„Ø§Ù‹ ğŸ‘† Ø«Ù… Ø§Ø¶ØºØ·ÙˆØ§ ØªØ£ÙƒÙŠØ¯ âœ…",
          "opt3.updatedBy": currentName || "unknown"
        });
        return;
      }

      if(currentName === "ANAS"){
        await pushRoomUpdate({ "opt3.confirmAnas": true, "opt3.updatedBy": currentName || "unknown" });
      }else{
        await pushRoomUpdate({ "opt3.confirmLana": true, "opt3.updatedBy": currentName || "unknown" });
      }

      await pushRoomUpdate({
        "opt3.lastText": "âœ… ØªÙ… ØªØ£ÙƒÙŠØ¯Ùƒ.\nÙ†Ø³ØªÙ†Ù‰ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠâ€¦",
        "opt3.updatedBy": currentName || "unknown"
      });
    });

    /********************
     * âœ… ØªÙ‚ÙŠÙŠÙ… Ø¨Ø¹Ø¯ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø«Ù†ÙŠÙ† + Ø§Ù†ØªÙ‚Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¥Ø°Ø§ ØµØ­
     ********************/
    let __autoNextTimer = null;

    async function evaluateIfNeeded(opt3){
      if(!currentName) return;

      const stage = Math.max(1, Math.min(150, parseInt(opt3?.stage||1,10)));
      const selected = parseInt(opt3?.selected ?? -1, 10);

      const bothConfirmed = !!opt3?.confirmAnas && !!opt3?.confirmLana;
      if(!bothConfirmed) return;

      const evaluatedStage = parseInt(opt3?.evaluatedStage||0, 10);
      if(evaluatedStage === stage) return;

      if((opt3?.updatedBy || "") !== currentName) return;

      const lvl = fishGetLevel(stage);
      const correct = parseInt(lvl?.[2] ?? 0, 10);
      const isCorrect = (selected === correct);

      if(isCorrect){
        const love = fishLoveTextForStage(stage);
        await pushRoomUpdate({
          "opt3.solved": true,
          "opt3.lastText": "âœ… ØªØ®Ø³ÙŠ Ø§Ù„Ø³Ù…ÙƒØ© Ø§Ø­Ù†Ø§ Ø§Ù‚ÙˆÙ‰ ğŸŸğŸ’ª",
          "opt3.loveText": love || "",
          "opt3.showLove": !!love,
          "opt3.evaluatedStage": stage,
          "opt3.autoNext": true,
          "opt3.autoNextDone": false,
          "opt3.updatedBy": currentName || "unknown"
        });
      }else{
        await pushRoomUpdate({
          "opt3.solved": false,
          "opt3.lastText": "âŒ ØºÙ„Ø·â€¦ Ø¬Ø±Ù‘Ø¨ÙˆØ§ Ø®ÙŠØ§Ø± Ø«Ø§Ù†ÙŠ ğŸ‘€\n(Ø§Ø®ØªØ§Ø±ÙˆØ§ Ù…Ù† Ø¬Ø¯ÙŠØ¯ Ø«Ù… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø«Ù†ÙŠÙ†)",
          "opt3.loveText": "",
          "opt3.showLove": false,
          "opt3.evaluatedStage": stage,
          "opt3.confirmAnas": false,
          "opt3.confirmLana": false,
          "opt3.updatedBy": currentName || "unknown"
        });
      }
    }

    async function autoNextIfNeeded(opt3){
      if(!currentName) return;
      const stage = Math.max(1, Math.min(150, parseInt(opt3?.stage||1,10)));

      const shouldAuto = !!opt3?.autoNext && !opt3?.autoNextDone && !!opt3?.solved;
      if(!shouldAuto) return;

      if((opt3?.updatedBy || "") !== currentName) return;

      if(__autoNextTimer) return;
      __autoNextTimer = setTimeout(async ()=>{
        __autoNextTimer = null;

        if(stage >= 150){
          await pushRoomUpdate({
            "opt3.lastText": "ğŸ‰ Ø®Ù„ØµØªÙˆØ§ Ø§Ù„Ù€ 150 Ù…Ø±Ø­Ù„Ø©! Ø£Ù†ØªÙ… Ø£Ù‚ÙˆÙ‰ Ù…Ù† Ø§Ù„Ø³Ù…ÙƒØ© ÙˆÙ…Ù† ÙƒÙ„ Ø´ÙŠ â¤ï¸",
            "opt3.showLove": true,
            "opt3.loveText": "Ø£Ù†Ø³ ÙˆÙ„Ø§Ù†Ø§â€¦ ÙˆØµÙ„ØªÙˆØ§ Ù„Ù„Ù†Ù‡Ø§ÙŠØ© Ù„Ø£Ù†ÙƒÙ… Ù…Ø§ ØªØªØ±ÙƒÙˆÙ† Ø¨Ø¹Ø¶.\nØ£Ø­Ø¨ÙƒÙ… ğŸ’—",
            "opt3.autoNextDone": true,
            "opt3.updatedBy": currentName || "unknown"
          });
          return;
        }

        const nextStage = stage + 1;
        await pushRoomUpdate({
          "opt3.stage": nextStage,
          "opt3.selected": -1,
          "opt3.solved": false,
          "opt3.lastText": "Ø§Ø®ØªØ§Ø±ÙˆØ§ Ø¬ÙˆØ§Ø¨ Ù…Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ğŸ‘† (Live)",
          "opt3.loveText": "",
          "opt3.showLove": false,
          "opt3.punishText": "",
          "opt3.confirmAnas": false,
          "opt3.confirmLana": false,
          "opt3.evaluatedStage": 0,
          "opt3.autoNext": false,
          "opt3.autoNextDone": true,
          "opt3.updatedBy": currentName || "unknown"
        });
      }, 900);
    }

    /********************
     * âœ… OPTION 4: PUZZLE 200 (Live Roles)
     ********************/
    const puzStageBadge = document.getElementById("puzStageBadge");
    const puzRoleBadge  = document.getElementById("puzRoleBadge");
    const puzSwapBtn    = document.getElementById("puzSwapBtn");
    const puzResetBtn   = document.getElementById("puzResetBtn");
    const puzNextBtn    = document.getElementById("puzNextBtn");
    const puzViewerPanel = document.getElementById("puzViewerPanel");
    const puzAssemblerPanel = document.getElementById("puzAssemblerPanel");
    const puzFullImg = document.getElementById("puzFullImg");
    const puzBoard = document.getElementById("puzBoard");
    const puzTray  = document.getElementById("puzTray");
    const puzStatus = document.getElementById("puzStatus");
    const puzSuccess = document.getElementById("puzSuccess");
    const puzViewerMini = document.getElementById("puzViewerMini");
    const puzAssemblerMini = document.getElementById("puzAssemblerMini");

    const PUZ_TOTAL = 200;

    /* âœ… Ù‡Ù†Ø§ ØªÙ‚Ø¯Ø± ØªØ­Ø· ØµÙˆØ±ÙƒÙ… (Ø±ÙˆØ§Ø¨Ø·) Ù„Ø§Ø­Ù‚Ù‹Ø§:
       - Ø§ÙƒØªØ¨ 200 Ø±Ø§Ø¨Ø· (Ø£Ùˆ Ø£Ù‚Ù„) Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØµÙÙˆÙØ© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø±Ø§Ø­Ù„
       - Ø¥Ø°Ø§ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ù…Ø§ Ù„Ù‡Ø§ Ø±Ø§Ø¨Ø· â†’ ÙŠØ³ØªØ®Ø¯Ù… Placeholder ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
    */
    const PUZ_CUSTOM_IMAGES = [
      // "https://.../1.jpg",
      // "https://.../2.jpg",
      // ...
    ];

    function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

    function puzGridForStage(stage){
      // ØªØµØ§Ø¹Ø¯ Ù„Ø·ÙŠÙ Ù„Ù„Ø¬ÙˆØ§Ù„
      if(stage <= 25) return 3;    // 3x3 = 9
      if(stage <= 120) return 4;   // 4x4 = 16
      return 5;                    // 5x5 = 25 (Ù„Ø¨Ø§Ù‚ÙŠ 200)
    }

    function puzCategory(stage){
      const cats = ["Cities","Animals","Hearts","Food"];
      return cats[(stage-1) % cats.length];
    }

    function svgToDataUrl(svg){
      return "data:image/svg+xml;charset=utf-8," + encodeURIComponent(svg);
    }

    function puzPlaceholderImage(stage){
      const cat = puzCategory(stage);
      const icon = (cat==="Cities") ? "ğŸ™ï¸" : (cat==="Animals") ? "ğŸ¾" : (cat==="Hearts") ? "ğŸ’—" : "ğŸ“";
      const hue = (stage * 17) % 360;
      const svg = `
<svg xmlns="http://www.w3.org/2000/svg" width="900" height="900" viewBox="0 0 900 900">
  <defs>
    <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0" stop-color="hsl(${hue},80%,18%)"/>
      <stop offset="1" stop-color="hsl(${(hue+55)%360},80%,22%)"/>
    </linearGradient>
    <radialGradient id="r" cx="30%" cy="25%" r="70%">
      <stop offset="0" stop-color="rgba(255,255,255,.18)"/>
      <stop offset="1" stop-color="rgba(255,255,255,0)"/>
    </radialGradient>
    <pattern id="p" width="70" height="70" patternUnits="userSpaceOnUse">
      <path d="M0 70 L70 0" stroke="rgba(255,255,255,.10)" stroke-width="2"/>
      <path d="M-10 35 L35 -10" stroke="rgba(255,255,255,.08)" stroke-width="2"/>
      <path d="M35 80 L80 35" stroke="rgba(255,255,255,.08)" stroke-width="2"/>
    </pattern>
  </defs>
  <rect width="900" height="900" fill="url(#g)"/>
  <rect width="900" height="900" fill="url(#p)" opacity="0.85"/>
  <rect width="900" height="900" fill="url(#r)"/>
  <circle cx="710" cy="720" r="240" fill="rgba(255,255,255,.06)"/>
  <circle cx="220" cy="220" r="190" fill="rgba(255,255,255,.05)"/>
  <text x="450" y="430" text-anchor="middle" font-family="system-ui,Segoe UI,Arial" font-size="110" font-weight="900" fill="rgba(255,255,255,.90)">Stage ${stage}</text>
  <text x="450" y="520" text-anchor="middle" font-family="system-ui,Segoe UI,Arial" font-size="48" font-weight="800" fill="rgba(255,255,255,.75)">${cat} ${icon}</text>
  <text x="450" y="610" text-anchor="middle" font-family="system-ui,Segoe UI,Arial" font-size="34" font-weight="700" fill="rgba(255,255,255,.55)">LANA â¤ï¸ ANAS</text>
</svg>`;
      return svgToDataUrl(svg);
    }

    function puzGetImage(stage){
      const idx = stage - 1;
      const url = PUZ_CUSTOM_IMAGES[idx];
      if(url && typeof url === "string" && url.trim()) return url.trim();
      return puzPlaceholderImage(stage);
    }

    function makeShuffle(n){
      const a = Array.from({length:n}, (_,i)=>i);
      for(let i=n-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]]=[a[j],a[i]];
      }
      return a;
    }

    function objKeysLen(obj){
      try{ return Object.keys(obj||{}).length; }catch(e){ return 0; }
    }

    function puzIsSolved(placed, n){
      // Ù„Ø§Ø²Ù… ÙƒÙ„ Ø§Ù„Ø³Ù„ÙˆØ·Ø§Øª Ù…ÙˆØ¬ÙˆØ¯Ø© ÙˆØµØ­ÙŠØ­Ø©
      for(let i=0;i<n;i++){
        const v = placed?.[String(i)];
        if(typeof v !== "number") return false;
        if(v !== i) return false;
      }
      return true;
    }

    function puzPieceStyle(grid, img, pieceIndex){
      const row = Math.floor(pieceIndex / grid);
      const col = pieceIndex % grid;
      const bgSize = `${grid*100}% ${grid*100}%`;
      const bgPos = `${(col/(grid-1))*100}% ${(row/(grid-1))*100}%`;
      // Ù…Ù„Ø§Ø­Ø¸Ø©: background-position Ø¨Ø§Ù„Ù†Ø³Ø¨ Ù…Ø¹ grid>1 Ù…Ù…ØªØ§Ø²
      return { bgSize, bgPos };
    }

    function puzCreatePieceEl(grid, img, pieceIndex){
      const el = document.createElement("div");
      el.className = "puzPiece";
      el.dataset.piece = String(pieceIndex);
      el.style.backgroundImage = `url("${img}")`;
      const row = Math.floor(pieceIndex / grid);
      const col = pieceIndex % grid;

      // background-size big so each piece shows a slice
      el.style.backgroundSize = `${grid*100}% ${grid*100}%`;
      el.style.backgroundPosition = `${(col/(grid-1))*100}% ${(row/(grid-1))*100}%`;

      return el;
    }

    function puzSetRoleUI(isViewer, roles){
      if(puzRoleBadge){
        const v = roles?.viewer || "â€”";
        const a = roles?.assembler || "â€”";
        puzRoleBadge.textContent = `Ø§Ù„Ø¯ÙˆØ±: ğŸ‘ï¸ ${v} | ğŸ§© ${a}`;
      }
      if(puzViewerPanel) puzViewerPanel.style.display = isViewer ? "block" : "none";
      if(puzAssemblerPanel) puzAssemblerPanel.style.display = isViewer ? "none" : "block";
    }

    async function puzEnsureStageFields(opt4puz){
      // Ù„Ùˆ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø© Ù‚Ø¯ÙŠÙ…Ø© ÙˆÙ…Ø§ ÙÙŠÙ‡Ø§ shuffle/img â†’ Ù†ÙˆÙ„Ù‘Ø¯Ù‡Ø§ Ù…Ø±Ø©
      const stage = clamp(parseInt(opt4puz?.stage||1,10), 1, PUZ_TOTAL);
      const grid = puzGridForStage(stage);
      const n = grid*grid;

      const img = (opt4puz?.img && typeof opt4puz.img==="string" && opt4puz.img.trim())
        ? opt4puz.img.trim()
        : puzGetImage(stage);

      let shuffle = Array.isArray(opt4puz?.shuffle) ? opt4puz.shuffle.slice(0) : [];
      if(shuffle.length !== n){
        shuffle = makeShuffle(n);
      }

      // Ø¥Ø°Ø§ ÙÙŠÙ‡ ÙØ±Ù‚ØŒ Ù†Ø³ÙˆÙŠ ØªØ­Ø¯ÙŠØ« Ø®ÙÙŠÙ
      const needUpdate = (opt4puz?.grid !== grid) || (opt4puz?.img !== img) || (!Array.isArray(opt4puz?.shuffle) || opt4puz.shuffle.length !== n);
      if(needUpdate){
        await pushRoomUpdate({
          "opt4puz.grid": grid,
          "opt4puz.img": img,
          "opt4puz.shuffle": shuffle,
          "opt4puz.updatedBy": currentName || "unknown"
        });
      }
    }

    function puzApplyUI(opt4puz){
      const stage = clamp(parseInt(opt4puz?.stage||1,10), 1, PUZ_TOTAL);
      const grid = puzGridForStage(stage);
      const n = grid*grid;

      const roles = opt4puz?.roles || {viewer:"ANAS", assembler:"LANA"};
      const isViewer = (currentName === (roles.viewer || "ANAS"));

      if(puzStageBadge) puzStageBadge.textContent = `Ø§Ù„Ù…Ø±Ø­Ù„Ø©: ${stage} / ${PUZ_TOTAL}`;
      puzSetRoleUI(isViewer, roles);

      const img = (opt4puz?.img && typeof opt4puz.img==="string" && opt4puz.img.trim())
        ? opt4puz.img.trim()
        : puzGetImage(stage);

      if(puzFullImg) puzFullImg.src = img;

      const placed = opt4puz?.placed || {};
      const sel = parseInt(opt4puz?.sel ?? -1, 10);
      const solved = !!opt4puz?.solved;

      if(puzViewerMini) puzViewerMini.textContent = `ÙÙ‚Ø· Ù„Ù„Ù…Ø´Ø§Ù‡Ø¯ â€¢ Ù…Ø±Ø­Ù„Ø© ${stage}`;
      if(puzAssemblerMini) puzAssemblerMini.textContent = `Ø§Ø®ØªÙŠØ§Ø±: ${sel >= 0 ? (sel+1) : "â€”"} â€¢ Ù‚Ø·Ø¹: ${n}`;

      // Board
      if(puzBoard){
        puzBoard.style.gridTemplateColumns = `repeat(${grid}, 1fr)`;
        puzBoard.innerHTML = "";
        for(let s=0;s<n;s++){
          const slot = document.createElement("div");
          slot.className = "puzSlot";
          slot.dataset.slot = String(s);

          const p = placed[String(s)];
          if(typeof p === "number"){
            slot.classList.add("filled");
            const piece = puzCreatePieceEl(grid, img, p);
            slot.appendChild(piece);

            // remove on click (assembler only)
            slot.addEventListener("click", async ()=>{
              const rolesNow = window.__puzRolesCache || roles;
              const isAssemblerNow = (currentName === (rolesNow.assembler || "LANA"));
              if(!isAssemblerNow) return;

              const nextPlaced = {...(window.__puzPlacedCache||placed)};
              delete nextPlaced[String(s)];
              await pushRoomUpdate({
                "opt4puz.placed": nextPlaced,
                "opt4puz.sel": -1,
                "opt4puz.solved": false,
                "opt4puz.updatedBy": currentName || "unknown"
              });
            });
          }else{
            // place selected piece (assembler only)
            slot.addEventListener("click", async ()=>{
              const rolesNow = window.__puzRolesCache || roles;
              const isAssemblerNow = (currentName === (rolesNow.assembler || "LANA"));
              if(!isAssemblerNow) return;

              const selected = parseInt(window.__puzSelCache ?? sel, 10);
              if(selected < 0) return;

              const nextPlaced = {...(window.__puzPlacedCache||placed)};
              // Ù…Ø§ Ù†Ø³Ù…Ø­ ØªÙƒØ±Ø§Ø± Ù†ÙØ³ Ø§Ù„Ù‚Ø·Ø¹Ø© ÙÙŠ Ø³Ù„ÙˆØ· Ø«Ø§Ù†ÙŠ: Ù†Ø´ÙŠÙ„Ù‡Ø§ Ù„Ùˆ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
              for(const k of Object.keys(nextPlaced)){
                if(nextPlaced[k] === selected) delete nextPlaced[k];
              }
              nextPlaced[String(s)] = selected;

              const done = puzIsSolved(nextPlaced, n);

              await pushRoomUpdate({
                "opt4puz.placed": nextPlaced,
                "opt4puz.sel": -1,
                "opt4puz.solved": done,
                "opt4puz.updatedBy": currentName || "unknown"
              });
            });
          }

          puzBoard.appendChild(slot);
        }
      }

      // Tray
      if(puzTray){
        puzTray.innerHTML = "";
        const shuffle = Array.isArray(opt4puz?.shuffle) ? opt4puz.shuffle.slice(0) : Array.from({length:n},(_,i)=>i);

        // determine which pieces are already used
        const used = new Set();
        for(const k of Object.keys(placed||{})){
          const v = placed[k];
          if(typeof v === "number") used.add(v);
        }

        // show remaining pieces in shuffle order
        for(const pieceIndex of shuffle){
          if(used.has(pieceIndex)) continue;

          const tile = document.createElement("div");
          tile.className = "puzTile";
          tile.dataset.piece = String(pieceIndex);

          if(pieceIndex === sel) tile.classList.add("selected");

          const pieceEl = puzCreatePieceEl(grid, img, pieceIndex);
          tile.appendChild(pieceEl);

          tile.addEventListener("click", async ()=>{
            const rolesNow = window.__puzRolesCache || roles;
            const isAssemblerNow = (currentName === (rolesNow.assembler || "LANA"));
            if(!isAssemblerNow) return;

            const currentSel = parseInt(window.__puzSelCache ?? sel, 10);
            const nextSel = (currentSel === pieceIndex) ? -1 : pieceIndex;
            await pushRoomUpdate({
              "opt4puz.sel": nextSel,
              "opt4puz.updatedBy": currentName || "unknown"
            });
          });

          puzTray.appendChild(tile);
        }
      }

      // Status / Next
      const placedCount = objKeysLen(placed);
      const remain = Math.max(0, n - placedCount);

      if(puzStatus){
        const by = opt4puz?.updatedBy || "â€”";
        puzStatus.textContent = `Live âœ… | Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${by}\nØ´Ø¨ÙƒØ©: ${grid}x${grid} | Ø¨Ø§Ù‚ÙŠ: ${remain} Ù‚Ø·Ø¹Ø©`;
      }

      if(puzSuccess){
        puzSuccess.classList.toggle("show", solved);
      }

      if(puzNextBtn){
        puzNextBtn.disabled = !solved;
      }
    }

    async function puzSwapRoles(){
      const roles = window.__puzRolesCache || {viewer:"ANAS", assembler:"LANA"};
      const nextRoles = { viewer: roles.assembler || "LANA", assembler: roles.viewer || "ANAS" };
      await pushRoomUpdate({
        "opt4puz.roles": nextRoles,
        "opt4puz.sel": -1,
        "opt4puz.updatedBy": currentName || "unknown"
      });
    }

    async function puzResetStage(){
      const stage = clamp(parseInt(window.__puzStageCache||1,10), 1, PUZ_TOTAL);
      const grid = puzGridForStage(stage);
      const n = grid*grid;

      const img = puzGetImage(stage);
      const shuffle = makeShuffle(n);

      await pushRoomUpdate({
        "opt4puz.grid": grid,
        "opt4puz.img": img,
        "opt4puz.shuffle": shuffle,
        "opt4puz.placed": {},
        "opt4puz.sel": -1,
        "opt4puz.solved": false,
        "opt4puz.updatedBy": currentName || "unknown"
      });
    }

    async function puzNextStage(){
      const stageNow = clamp(parseInt(window.__puzStageCache||1,10), 1, PUZ_TOTAL);
      if(stageNow >= PUZ_TOTAL) {
        await pushRoomUpdate({
          "opt4puz.solved": true,
          "opt4puz.updatedBy": currentName || "unknown"
        });
        return;
      }
      const nextStage = stageNow + 1;
      const grid = puzGridForStage(nextStage);
      const n = grid*grid;

      const img = puzGetImage(nextStage);
      const shuffle = makeShuffle(n);

      await pushRoomUpdate({
        "opt4puz.stage": nextStage,
        "opt4puz.grid": grid,
        "opt4puz.img": img,
        "opt4puz.shuffle": shuffle,
        "opt4puz.placed": {},
        "opt4puz.sel": -1,
        "opt4puz.solved": false,
        "opt4puz.updatedBy": currentName || "unknown"
      });
    }

    puzSwapBtn?.addEventListener("click", puzSwapRoles);
    puzResetBtn?.addEventListener("click", puzResetStage);
    puzNextBtn?.addEventListener("click", puzNextStage);

    /********************
     * Room listener
     ********************/
    function startRoomListener(){
      if(unsubRoom) return;

      unsubRoom = window.fb.onSnapshot(roomRef(), (snap)=>{
        const data = snap.data() || {};

        if(data.currentPage){
          showPageLocal(data.currentPage);
        }

        if(data.currentMode && modeSelect.value !== data.currentMode){
          modeSelect.value = data.currentMode;
          CURRENT_MODE = data.currentMode;
        }

        if(typeof data.promptText === "string" && promptCard){
          promptCard.textContent = data.promptText;
        }

        const by = data.lastBy || "â€”";
        if(syncLine){
          syncLine.textContent = `Ù…ØªØ²Ø§Ù…Ù† âœ… | Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${by} | Ø§Ù„Ù…Ø±Ø­Ù„Ø©: ${CURRENT_MODE}`;
        }

        // ===== Option 2 sync =====
        const opt2 = data.opt2 || {};

        if(amkMeAs && amkOtherAs && currentName){
          amkMeAs.textContent = (currentName === "ANAS") ? "LANA" : "ANAS";
          amkOtherAs.textContent = (currentName === "ANAS") ? "ANAS" : "LANA";
        }

        if(amkHintMe) amkHintMe.textContent = "Ø§ÙƒØªØ¨ ÙƒØ£Ù†Ùƒ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠâ€¦ Ø¨Ø¶Ù…ÙŠØ±Ù‡ ÙˆÙ…Ø´Ø§Ø¹Ø±Ù‡.";
        if(amkHintOther) amkHintOther.textContent = "ØªØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ø­ÙØ¸ Ø§Ù„Ø§Ø«Ù†ÙŠÙ† âœ…";

        if(amkQuestion){
          amkQuestion.textContent = (typeof opt2.q === "string" && opt2.q) ? `â“ ${opt2.q}` : "â“ Ø§Ø¶ØºØ· (Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯) ğŸŒ¹";
        }

        const mine = (opt2[myKey()] || "");
        const other = (opt2[otherKey()] || "");

        safeSetTextareaValue(amkMe, mine);

        const bothReady = !!opt2[myReadyKey()] && !!opt2[otherReadyKey()];
        if(amkOther){
          if(bothReady){
            amkOther.value = other || "â€”";
          }else{
            amkOther.value = "ğŸ”’ Ù„Ù† ØªØ¸Ù‡Ø± Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø­ØªÙ‰ ØªØ­ÙØ¸ÙˆÙ† Ø£Ù†ØªÙ… Ø§Ù„Ø§Ø«Ù†ÙŠÙ† ğŸ’—";
          }
        }

        if(amkStatus){
          const by2 = opt2.updatedBy || data.lastBy || "â€”";
          amkStatus.textContent = `Live âœ… | Ø­ÙØ¸ Ø£Ù†Ø³: ${opt2.readyAnas ? "âœ…" : "â€”"} | Ø­ÙØ¸ Ù„Ø§Ù†Ø§: ${opt2.readyLana ? "âœ…" : "â€”"} | Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${by2}`;
        }

        // ===== Option 3 sync =====
        const opt3 = data.opt3 || {};
        const stage = Math.max(1, Math.min(150, parseInt(opt3.stage||1,10)));
        window.__fishStageCache = stage;
        window.__fishSelectedCache = parseInt(opt3.selected ?? -1, 10);
        window.__fishSolvedCache = !!opt3.solved;
        window.__fishConfirmAnasCache = !!opt3.confirmAnas;
        window.__fishConfirmLanaCache = !!opt3.confirmLana;

        applyFishUI(opt3);
        evaluateIfNeeded(opt3);
        autoNextIfNeeded(opt3);

        if(fishStatus){
          const who = opt3.updatedBy || data.lastBy || "â€”";
          fishStatus.textContent = `Live âœ… | Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${who} | Ù…Ø±Ø­Ù„Ø©: ${stage} | Ø§Ø®ØªÙŠØ§Ø±: ${window.__fishSelectedCache}`;
        }

        // ===== âœ… Option 4 puzzle sync =====
        const opt4puz = data.opt4puz || {};
        const puzStage = clamp(parseInt(opt4puz.stage||1,10), 1, PUZ_TOTAL);

        window.__puzStageCache = puzStage;
        window.__puzSelCache = parseInt(opt4puz.sel ?? -1, 10);
        window.__puzPlacedCache = opt4puz.placed || {};
        window.__puzRolesCache = opt4puz.roles || {viewer:"ANAS", assembler:"LANA"};

        // Ø¶Ù…Ø§Ù† Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø±Ø­Ù„Ø© (img/shuffle/grid)
        // (Ù„Ø§ Ù†Ø­Ø¯Ø« Ù‡Ù†Ø§ Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ù… Ù„ØªÙØ§Ø¯ÙŠ loopØŒ Ù„ÙƒÙ† Ù„Ùˆ Ù†Ø§Ù‚ØµØŒ Ù†Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©)
        if((data.currentPage === "pageOpt4") && currentName){
          // ØªØ­Ø¯ÙŠØ« Ø®ÙÙŠÙ ÙÙ‚Ø· Ø¥Ø°Ø§ Ù†Ø§Ù‚Øµ
          puzEnsureStageFields(opt4puz);
        }

        puzApplyUI(opt4puz);
      });
    }

    /********************
     * Bind UI
     ********************/
    document.getElementById("backHomeBtn")?.addEventListener("click", ()=> pushPage("pageHome"));
    document.querySelectorAll(".backAny").forEach(b=> b.addEventListener("click", ()=> pushPage("pageHome")));

    document.getElementById("btnQ")?.addEventListener("click", ()=> pushPrompt("q"));
    document.getElementById("btnC")?.addEventListener("click", ()=> pushPrompt("c"));

    modeSelect.addEventListener("change", async ()=>{
      CURRENT_MODE = modeSelect.value || "lana1";
      await pushRoomUpdate({ currentMode: CURRENT_MODE });
    });

    document.querySelectorAll(".opt").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const go = btn.getAttribute("data-go");
        closeModalFn();
        if(go) pushPage(go);
      });
    });

    /********************
     * Start after Firebase
     ********************/
    (async ()=>{
      await waitForFb();

      window.fb.onAuthStateChanged(window.fb.auth, async (user)=>{
        if(!user){
          currentName = null;
          topbar.classList.add("hide");
          showPageLocal("pageLogin");
          return;
        }

        const em = (user.email||"").toLowerCase();
        currentName = em.startsWith("lana") ? "LANA" : "ANAS";

        whoPill.textContent = `ğŸ’— Ø£Ù†Øª: ${currentName}`;
        topbar.classList.remove("hide");

        CURRENT_MODE = modeSelect.value || "lana1";

        await ensureRoom();
        startRoomListener();

        pushPage("pageHome");
      });

      window.addEventListener("visibilitychange", ()=>{
        if(document.visibilityState==="visible" && window.fb?.auth?.currentUser){
          ensureRoom();
        }
      });
    })();
  </script>

  <script>
    function updateLoveCounter(){
      const startDate = new Date(2025, 10, 24);
      const today = new Date();
      const diffTime = today.getTime() - startDate.getTime();
      const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
      const counterEl = document.getElementById("loveCounter");
      if(counterEl){
        counterEl.textContent = `ğŸ’— ${diffDays} DAY`;
      }
    }
    updateLoveCounter();
    setInterval(updateLoveCounter, 1000 * 60 * 60);
  </script>

  <script>
    // ğŸ”’ Ø®Ø±ÙˆØ¬ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø© Ø£Ùˆ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
    window.addEventListener("beforeunload", () => {
      try {
        if (window.fb?.auth?.currentUser) {
          window.fb.signOut(window.fb.auth);
        }
      } catch (e) {}
    });
  </script>

</body>
</html>
